"use strict";(self.webpackChunklinku_admin=self.webpackChunklinku_admin||[]).push([[819],{1819(e,t,r){r.r(t),r.d(t,{default:()=>u});var i=r(5043),s=r(3216),d=r(9379),n=r(6204),o=r(638),l=r(579);const a=e=>{let{request:t,onClose:r,onUpdate:s}=e;const[n,a]=(0,i.useState)({status:t.status,priority:t.priority,admin_response:t.admin_response||""});return(0,l.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1100},children:(0,l.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"20px",maxWidth:"600px",width:"90%",maxHeight:"80vh",overflow:"auto",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",paddingBottom:"10px",borderBottom:"1px solid #eee"},children:[(0,l.jsx)("h3",{style:{margin:0},children:"\u8bf7\u6c42\u8be6\u60c5"}),(0,l.jsx)("button",{onClick:r,style:{padding:"6px 12px",border:"none",background:"#dc3545",color:"white",borderRadius:"4px",cursor:"pointer"},children:"\u5173\u95ed"})]}),(0,l.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,l.jsx)("h4",{style:{margin:"0 0 10px 0"},children:t.title}),(0,l.jsxs)("div",{style:{color:"#666",marginBottom:"15px"},children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"\u8bf7\u6c42\u8005:"})," ",t.requester_name," (",t.requester_id,")"]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"\u7c7b\u578b:"})," ",c(t.type)]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"\u521b\u5efa\u65f6\u95f4:"})," ",o.IX.formatUtcToLocal(t.created_at,"YYYY-MM-DD HH:mm:ss")]})]}),(0,l.jsxs)("div",{style:{padding:"15px",backgroundColor:"#f8f9fa",borderRadius:"6px",marginBottom:"15px"},children:[(0,l.jsx)("strong",{children:"\u8bf7\u6c42\u63cf\u8ff0:"}),(0,l.jsx)("p",{style:{margin:"10px 0 0 0",whiteSpace:"pre-wrap"},children:t.description})]})]}),(0,l.jsxs)("form",{onSubmit:e=>{e.preventDefault(),s(t.id,n),r()},children:[(0,l.jsxs)("div",{style:{display:"grid",gap:"15px"},children:[(0,l.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px"},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"\u72b6\u6001:"}),(0,l.jsxs)("select",{value:n.status,onChange:e=>a(t=>(0,d.A)((0,d.A)({},t),{},{status:e.target.value})),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},children:[(0,l.jsx)("option",{value:"pending",children:"\u5f85\u5904\u7406"}),(0,l.jsx)("option",{value:"processing",children:"\u5904\u7406\u4e2d"}),(0,l.jsx)("option",{value:"completed",children:"\u5df2\u5b8c\u6210"}),(0,l.jsx)("option",{value:"rejected",children:"\u5df2\u62d2\u7edd"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"\u4f18\u5148\u7ea7:"}),(0,l.jsxs)("select",{value:n.priority,onChange:e=>a(t=>(0,d.A)((0,d.A)({},t),{},{priority:e.target.value})),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},children:[(0,l.jsx)("option",{value:"low",children:"\u4f4e"}),(0,l.jsx)("option",{value:"medium",children:"\u4e2d"}),(0,l.jsx)("option",{value:"high",children:"\u9ad8"})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"\u7ba1\u7406\u5458\u56de\u590d:"}),(0,l.jsx)("textarea",{value:n.admin_response,onChange:e=>a(t=>(0,d.A)((0,d.A)({},t),{},{admin_response:e.target.value})),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",minHeight:"100px",resize:"vertical"},placeholder:"\u8bf7\u8f93\u5165\u56de\u590d\u5185\u5bb9..."})]})]}),(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px",paddingTop:"15px",borderTop:"1px solid #eee"},children:[(0,l.jsx)("button",{type:"button",onClick:r,style:{padding:"8px 16px",border:"1px solid #ddd",background:"white",borderRadius:"4px",cursor:"pointer"},children:"\u53d6\u6d88"}),(0,l.jsx)("button",{type:"submit",style:{padding:"8px 16px",border:"none",background:"#28a745",color:"white",borderRadius:"4px",cursor:"pointer"},children:"\u4fdd\u5b58"})]})]})]})})},p=e=>{let{onClose:t,onSend:r,newMessage:i,setNewMessage:s}=e;return(0,l.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1100},children:(0,l.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"20px",maxWidth:"500px",width:"90%",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",paddingBottom:"10px",borderBottom:"1px solid #eee"},children:[(0,l.jsx)("h3",{style:{margin:0},children:"\u53d1\u9001\u6d88\u606f\u7ed9\u5ba2\u670d"}),(0,l.jsx)("button",{onClick:t,style:{padding:"6px 12px",border:"none",background:"#dc3545",color:"white",borderRadius:"4px",cursor:"pointer"},children:"\u5173\u95ed"})]}),(0,l.jsxs)("form",{onSubmit:e=>{e.preventDefault(),r(),t()},children:[(0,l.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,l.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"\u6d88\u606f\u5185\u5bb9:"}),(0,l.jsx)("textarea",{value:i,onChange:e=>s(e.target.value),style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"4px",minHeight:"120px",resize:"vertical"},placeholder:"\u8bf7\u8f93\u5165\u8981\u53d1\u9001\u7ed9\u5ba2\u670d\u7684\u6d88\u606f...",required:!0})]}),(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[(0,l.jsx)("button",{type:"button",onClick:t,style:{padding:"8px 16px",border:"1px solid #ddd",background:"white",borderRadius:"4px",cursor:"pointer"},children:"\u53d6\u6d88"}),(0,l.jsx)("button",{type:"submit",style:{padding:"8px 16px",border:"none",background:"#28a745",color:"white",borderRadius:"4px",cursor:"pointer"},children:"\u53d1\u9001"})]})]})]})})},c=e=>{switch(e){case"task_status":return"\u4efb\u52a1\u72b6\u6001";case"user_ban":return"\u7528\u6237\u5c01\u7981";case"feedback":return"\u53cd\u9988\u5efa\u8bae";case"other":return"\u5176\u4ed6";default:return e}},x=e=>{let{onClose:t}=e;const[r,s]=(0,i.useState)("requests"),[c,x]=(0,i.useState)([]),[u,h]=(0,i.useState)([]),[g,y]=(0,i.useState)(!1),[b,m]=(0,i.useState)(null),[j,f]=(0,i.useState)(!1),[v,w]=(0,i.useState)(!1),[k,C]=(0,i.useState)({status:"",priority:""}),[S,R]=(0,i.useState)(""),B=async()=>{try{y(!0);const e=await(0,n.fE)(k);x(e.requests||[])}catch(e){}finally{y(!1)}},_=async()=>{try{y(!0);const e=await(0,n.ZP)();h(e.messages||[])}catch(e){}finally{y(!1)}};(0,i.useEffect)(()=>{"requests"===r?B():_()},[r,k]);const I=e=>{switch(e){case"pending":return"#ffc107";case"processing":return"#17a2b8";case"completed":return"#28a745";case"rejected":return"#dc3545";default:return"#6c757d"}},z=e=>{switch(e){case"pending":return"\u5f85\u5904\u7406";case"processing":return"\u5904\u7406\u4e2d";case"completed":return"\u5df2\u5b8c\u6210";case"rejected":return"\u5df2\u62d2\u7edd";default:return e}},q=e=>{switch(e){case"high":return"#dc3545";case"medium":return"#ffc107";case"low":return"#28a745";default:return"#6c757d"}},A=e=>{switch(e){case"high":return"\u9ad8";case"medium":return"\u4e2d";case"low":return"\u4f4e";default:return e}},H=e=>{switch(e){case"task_status":return"\u4efb\u52a1\u72b6\u6001";case"user_ban":return"\u7528\u6237\u5c01\u7981";case"feedback":return"\u53cd\u9988\u5efa\u8bae";case"other":return"\u5176\u4ed6";default:return e}};return(0,l.jsxs)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:[(0,l.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"20px",maxWidth:"1200px",width:"95%",maxHeight:"90vh",overflow:"auto",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",paddingBottom:"10px",borderBottom:"1px solid #eee"},children:[(0,l.jsx)("h2",{style:{margin:0,color:"#333"},children:"\u5ba2\u670d\u7ba1\u7406"}),(0,l.jsx)("button",{onClick:t,style:{padding:"8px 16px",border:"none",background:"#dc3545",color:"white",borderRadius:"4px",cursor:"pointer"},children:"\u5173\u95ed"})]}),(0,l.jsxs)("div",{style:{display:"flex",gap:"10px",marginBottom:"20px",borderBottom:"1px solid #eee"},children:[(0,l.jsx)("button",{onClick:()=>s("requests"),style:{padding:"10px 20px",border:"none",background:"requests"===r?"#007bff":"#f0f0f0",color:"requests"===r?"white":"black",cursor:"pointer",borderRadius:"5px 5px 0 0",fontSize:"14px",fontWeight:"500"},children:"\u5ba2\u670d\u8bf7\u6c42"}),(0,l.jsx)("button",{onClick:()=>s("chat"),style:{padding:"10px 20px",border:"none",background:"chat"===r?"#007bff":"#f0f0f0",color:"chat"===r?"white":"black",cursor:"pointer",borderRadius:"5px 5px 0 0",fontSize:"14px",fontWeight:"500"},children:"\u5ba2\u670d\u4ea4\u6d41"})]}),"requests"===r&&(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{style:{display:"flex",gap:"10px",marginBottom:"20px",padding:"15px",backgroundColor:"#f8f9fa",borderRadius:"6px"},children:[(0,l.jsxs)("select",{value:k.status,onChange:e=>C(t=>(0,d.A)((0,d.A)({},t),{},{status:e.target.value})),style:{padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},children:[(0,l.jsx)("option",{value:"",children:"\u5168\u90e8\u72b6\u6001"}),(0,l.jsx)("option",{value:"pending",children:"\u5f85\u5904\u7406"}),(0,l.jsx)("option",{value:"processing",children:"\u5904\u7406\u4e2d"}),(0,l.jsx)("option",{value:"completed",children:"\u5df2\u5b8c\u6210"}),(0,l.jsx)("option",{value:"rejected",children:"\u5df2\u62d2\u7edd"})]}),(0,l.jsxs)("select",{value:k.priority,onChange:e=>C(t=>(0,d.A)((0,d.A)({},t),{},{priority:e.target.value})),style:{padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},children:[(0,l.jsx)("option",{value:"",children:"\u5168\u90e8\u4f18\u5148\u7ea7"}),(0,l.jsx)("option",{value:"high",children:"\u9ad8"}),(0,l.jsx)("option",{value:"medium",children:"\u4e2d"}),(0,l.jsx)("option",{value:"low",children:"\u4f4e"})]})]}),(0,l.jsx)("div",{style:{overflow:"auto",maxHeight:"500px"},children:g?(0,l.jsx)("div",{style:{textAlign:"center",padding:"20px"},children:"\u52a0\u8f7d\u4e2d..."}):0===c.length?(0,l.jsx)("div",{style:{textAlign:"center",padding:"20px",color:"#666"},children:"\u6682\u65e0\u5ba2\u670d\u8bf7\u6c42"}):(0,l.jsx)("div",{style:{display:"grid",gap:"15px"},children:c.map(e=>(0,l.jsxs)("div",{style:{border:"1px solid #eee",borderRadius:"6px",padding:"15px",backgroundColor:"#fff"},children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"10px"},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{style:{margin:"0 0 5px 0",color:"#333"},children:e.title}),(0,l.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[(0,l.jsxs)("span",{style:{color:"#666",fontSize:"14px"},children:["\u6765\u81ea: ",e.requester_name," (",e.requester_id,")"]}),(0,l.jsx)("span",{style:{padding:"2px 8px",borderRadius:"4px",color:"white",backgroundColor:I(e.status),fontSize:"12px"},children:z(e.status)}),(0,l.jsx)("span",{style:{padding:"2px 8px",borderRadius:"4px",color:"white",backgroundColor:q(e.priority),fontSize:"12px"},children:A(e.priority)}),(0,l.jsx)("span",{style:{color:"#666",fontSize:"12px"},children:H(e.type)})]})]}),(0,l.jsx)("div",{style:{display:"flex",gap:"5px"},children:(0,l.jsx)("button",{onClick:()=>(async e=>{try{const t=await(0,n.ln)(e);m(t.request),f(!0)}catch(t){}})(e.id),style:{padding:"4px 8px",border:"none",background:"#17a2b8",color:"white",borderRadius:"3px",cursor:"pointer",fontSize:"12px"},children:"\u67e5\u770b"})})]}),(0,l.jsx)("div",{style:{color:"#666",fontSize:"14px",marginBottom:"10px",maxHeight:"60px",overflow:"hidden",textOverflow:"ellipsis"},children:e.description}),(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"12px",color:"#999"},children:[(0,l.jsxs)("span",{children:["\u521b\u5efa\u65f6\u95f4: ",o.IX.formatUtcToLocal(e.created_at,"YYYY-MM-DD HH:mm")]}),e.updated_at&&(0,l.jsxs)("span",{children:["\u66f4\u65b0\u65f6\u95f4: ",o.IX.formatUtcToLocal(e.updated_at,"YYYY-MM-DD HH:mm")]})]})]},e.id))})})]}),"chat"===r&&(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,l.jsx)("h3",{style:{margin:0},children:"\u4e0e\u5ba2\u670d\u7684\u4ea4\u6d41\u8bb0\u5f55"}),(0,l.jsx)("button",{onClick:()=>w(!0),style:{padding:"8px 16px",border:"none",background:"#28a745",color:"white",borderRadius:"4px",cursor:"pointer"},children:"\u53d1\u9001\u6d88\u606f"})]}),(0,l.jsx)("div",{style:{height:"400px",overflow:"auto",border:"1px solid #eee",borderRadius:"6px",padding:"15px",backgroundColor:"#f8f9fa"},children:g?(0,l.jsx)("div",{style:{textAlign:"center",padding:"20px"},children:"\u52a0\u8f7d\u4e2d..."}):0===u.length?(0,l.jsx)("div",{style:{textAlign:"center",padding:"20px",color:"#666"},children:"\u6682\u65e0\u804a\u5929\u8bb0\u5f55"}):(0,l.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:u.map(e=>(0,l.jsx)("div",{style:{display:"flex",justifyContent:"admin"===e.sender_type?"flex-end":"flex-start"},children:(0,l.jsxs)("div",{style:{maxWidth:"70%",padding:"10px 15px",borderRadius:"18px",backgroundColor:"admin"===e.sender_type?"#007bff":"#e9ecef",color:"admin"===e.sender_type?"white":"#333"},children:[(0,l.jsx)("div",{style:{fontSize:"12px",opacity:.8,marginBottom:"5px"},children:e.sender_name||("admin"===e.sender_type?"\u7ba1\u7406\u5458":"\u5ba2\u670d")}),(0,l.jsx)("div",{children:e.content}),(0,l.jsx)("div",{style:{fontSize:"11px",opacity:.7,marginTop:"5px",textAlign:"right"},children:o.IX.formatUtcToLocal(e.created_at,"HH:mm")})]})},e.id))})})]})]}),j&&b&&(0,l.jsx)(a,{request:b,onClose:()=>f(!1),onUpdate:async(e,t)=>{try{await(0,n.rI)(e,t),await B(),alert("\u8bf7\u6c42\u66f4\u65b0\u6210\u529f")}catch(r){alert("\u66f4\u65b0\u8bf7\u6c42\u5931\u8d25")}}}),v&&(0,l.jsx)(p,{onClose:()=>w(!1),onSend:async()=>{if(S.trim())try{await(0,n.Ik)(S),R(""),await _()}catch(e){alert("\u53d1\u9001\u6d88\u606f\u5931\u8d25")}},newMessage:S,setNewMessage:R})]})},u=()=>{const e=(0,s.Zp)();return(0,l.jsx)(x,{onClose:()=>e("/admin")})}}}]);
//# sourceMappingURL=819.c1f77a00.chunk.js.map