{"version":3,"file":"static/js/239.8d2a24a7.chunk.js","mappings":"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","sources":["pages/admin/invitations/InvitationManagement.tsx"],"sourcesContent":["import React, { useState, useCallback } from 'react';\r\nimport { message } from 'antd';\r\nimport { useAdminTable, useModalForm } from '../../../hooks';\r\nimport { AdminTable, AdminPagination, AdminModal, Column, StatusBadge } from '../../../components/admin';\r\nimport {\r\n  getInvitationCodes,\r\n  createInvitationCode,\r\n  updateInvitationCode,\r\n  deleteInvitationCode,\r\n  getInvitationCodeDetail,\r\n} from '../../../api';\r\nimport { getErrorMessage } from '../../../utils/errorHandler';\r\n\r\ninterface InvitationCode {\r\n  id: number;\r\n  code: string;\r\n  name?: string;\r\n  description?: string;\r\n  reward_type: 'points' | 'coupon' | 'both';\r\n  points_reward?: number;\r\n  points_reward_display?: string;\r\n  coupon_id?: number;\r\n  used_count: number;\r\n  max_uses?: number;\r\n  valid_from: string;\r\n  valid_until: string;\r\n  is_active: boolean;\r\n}\r\n\r\ninterface FormData {\r\n  id?: number;\r\n  code: string;\r\n  name: string;\r\n  description: string;\r\n  reward_type: 'points' | 'coupon' | 'both';\r\n  points_reward: number;\r\n  coupon_id?: number;\r\n  max_uses?: number;\r\n  valid_from: string;\r\n  valid_until: string;\r\n  is_active: boolean;\r\n}\r\n\r\nconst initialForm: FormData = {\r\n  code: '',\r\n  name: '',\r\n  description: '',\r\n  reward_type: 'points',\r\n  points_reward: 0,\r\n  coupon_id: undefined,\r\n  max_uses: undefined,\r\n  valid_from: '',\r\n  valid_until: '',\r\n  is_active: true,\r\n};\r\n\r\n/**\r\n * 邀请码管理组件\r\n */\r\nconst InvitationManagement: React.FC = () => {\r\n  const [statusFilter, setStatusFilter] = useState<string>('');\r\n\r\n  const fetchCodes = useCallback(async ({ page, pageSize, filters }: { page: number; pageSize: number; filters?: Record<string, any> }) => {\r\n    const response = await getInvitationCodes({\r\n      page,\r\n      limit: pageSize,\r\n      status: filters?.status as 'active' | 'inactive' | undefined,\r\n    });\r\n    return {\r\n      data: response.data || response.items || [],\r\n      total: response.total || 0,\r\n    };\r\n  }, []);\r\n\r\n  const handleFetchError = useCallback((error: any) => {\r\n    message.error(getErrorMessage(error));\r\n  }, []);\r\n\r\n  const table = useAdminTable<InvitationCode>({\r\n    fetchData: fetchCodes,\r\n    initialPageSize: 20,\r\n    onError: handleFetchError,\r\n  });\r\n\r\n  const modal = useModalForm<FormData>({\r\n    initialValues: initialForm,\r\n    onSubmit: async (values, isEdit) => {\r\n      if (!values.code || !values.valid_from || !values.valid_until) {\r\n        message.warning('请填写邀请码、有效期开始时间和结束时间');\r\n        throw new Error('validation');\r\n      }\r\n\r\n      if (isEdit && values.id) {\r\n        await updateInvitationCode(values.id, {\r\n          name: values.name || undefined,\r\n          description: values.description || undefined,\r\n          is_active: values.is_active,\r\n          max_uses: values.max_uses,\r\n          valid_from: values.valid_from ? new Date(values.valid_from).toISOString() : undefined,\r\n          valid_until: values.valid_until ? new Date(values.valid_until).toISOString() : undefined,\r\n          points_reward: values.points_reward || undefined,\r\n          coupon_id: values.coupon_id,\r\n        });\r\n        message.success('邀请码更新成功！');\r\n      } else {\r\n        await createInvitationCode({\r\n          code: values.code,\r\n          name: values.name || undefined,\r\n          description: values.description || undefined,\r\n          reward_type: values.reward_type,\r\n          points_reward: values.points_reward || undefined,\r\n          coupon_id: values.coupon_id,\r\n          max_uses: values.max_uses,\r\n          valid_from: new Date(values.valid_from).toISOString(),\r\n          valid_until: new Date(values.valid_until).toISOString(),\r\n          is_active: values.is_active,\r\n        });\r\n        message.success('邀请码创建成功！');\r\n      }\r\n\r\n      table.refresh();\r\n    },\r\n    onError: (error: any) => {\r\n      if (error?.message !== 'validation') {\r\n        message.error(getErrorMessage(error));\r\n      }\r\n    },\r\n  });\r\n\r\n  const handleEdit = useCallback(async (id: number) => {\r\n    try {\r\n      const detail = await getInvitationCodeDetail(id);\r\n      modal.open({\r\n        id: detail.id,\r\n        code: detail.code,\r\n        name: detail.name || '',\r\n        description: detail.description || '',\r\n        reward_type: detail.reward_type,\r\n        points_reward: detail.points_reward || 0,\r\n        coupon_id: detail.coupon_id,\r\n        max_uses: detail.max_uses,\r\n        valid_from: detail.valid_from ? new Date(detail.valid_from).toISOString().slice(0, 16) : '',\r\n        valid_until: detail.valid_until ? new Date(detail.valid_until).toISOString().slice(0, 16) : '',\r\n        is_active: detail.is_active,\r\n      });\r\n    } catch (error: any) {\r\n      message.error(getErrorMessage(error));\r\n    }\r\n  }, [modal]);\r\n\r\n  const handleDelete = useCallback((id: number) => {\r\n    if (!window.confirm('确定要删除这个邀请码吗？')) return;\r\n    deleteInvitationCode(id)\r\n      .then(() => {\r\n        message.success('邀请码删除成功！');\r\n        table.refresh();\r\n      })\r\n      .catch((error: any) => {\r\n        message.error(getErrorMessage(error));\r\n      });\r\n  }, [table]);\r\n\r\n  const handleStatusFilterChange = useCallback((status: string) => {\r\n    setStatusFilter(status);\r\n    table.setFilters({ status: status || undefined });\r\n  }, [table]);\r\n\r\n  const columns: Column<InvitationCode>[] = [\r\n    {\r\n      key: 'code',\r\n      title: '邀请码',\r\n      dataIndex: 'code',\r\n      width: 120,\r\n    },\r\n    {\r\n      key: 'name',\r\n      title: '名称',\r\n      dataIndex: 'name',\r\n      width: 140,\r\n      render: (value) => value || '-',\r\n    },\r\n    {\r\n      key: 'reward_type',\r\n      title: '奖励类型',\r\n      dataIndex: 'reward_type',\r\n      width: 120,\r\n      render: (value) =>\r\n        value === 'points' ? '积分' : value === 'coupon' ? '优惠券' : '积分+优惠券',\r\n    },\r\n    {\r\n      key: 'points_reward',\r\n      title: '积分奖励',\r\n      dataIndex: 'points_reward_display',\r\n      width: 100,\r\n      render: (value) => value || '0.00',\r\n    },\r\n    {\r\n      key: 'usage',\r\n      title: '使用次数',\r\n      width: 100,\r\n      render: (_, record) => `${record.used_count || 0} / ${record.max_uses || '∞'}`,\r\n    },\r\n    {\r\n      key: 'validity',\r\n      title: '有效期',\r\n      width: 200,\r\n      render: (_, record) => (\r\n        <span style={{ fontSize: '12px' }}>\r\n          {new Date(record.valid_from).toLocaleString('zh-CN')} ~<br />\r\n          {new Date(record.valid_until).toLocaleString('zh-CN')}\r\n        </span>\r\n      ),\r\n    },\r\n    {\r\n      key: 'status',\r\n      title: '状态',\r\n      dataIndex: 'is_active',\r\n      width: 80,\r\n      render: (value) => (\r\n        <StatusBadge\r\n          text={value ? '启用' : '禁用'}\r\n          variant={value ? 'success' : 'danger'}\r\n        />\r\n      ),\r\n    },\r\n    {\r\n      key: 'actions',\r\n      title: '操作',\r\n      width: 120,\r\n      align: 'center',\r\n      render: (_, record) => (\r\n        <div style={{ display: 'flex', gap: '8px', justifyContent: 'center' }}>\r\n          <button\r\n            onClick={() => handleEdit(record.id)}\r\n            style={{ padding: '4px 8px', border: '1px solid #007bff', background: 'white', color: '#007bff', borderRadius: '4px', cursor: 'pointer', fontSize: '12px' }}\r\n          >\r\n            编辑\r\n          </button>\r\n          <button\r\n            onClick={() => handleDelete(record.id)}\r\n            style={{ padding: '4px 8px', border: '1px solid #dc3545', background: 'white', color: '#dc3545', borderRadius: '4px', cursor: 'pointer', fontSize: '12px' }}\r\n          >\r\n            删除\r\n          </button>\r\n        </div>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  const modalFooter = (\r\n    <div style={{ display: 'flex', justifyContent: 'flex-end', gap: '8px' }}>\r\n      <button\r\n        onClick={modal.close}\r\n        style={{ padding: '8px 16px', border: '1px solid #d9d9d9', borderRadius: '4px', background: 'white', cursor: 'pointer' }}\r\n      >\r\n        取消\r\n      </button>\r\n      <button\r\n        onClick={modal.handleSubmit}\r\n        disabled={modal.loading}\r\n        style={{ padding: '8px 16px', border: 'none', borderRadius: '4px', background: '#007bff', color: 'white', cursor: modal.loading ? 'not-allowed' : 'pointer', opacity: modal.loading ? 0.7 : 1 }}\r\n      >\r\n        {modal.loading ? '提交中...' : modal.isEdit ? '更新' : '创建'}\r\n      </button>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div>\r\n      {/* Header */}\r\n      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>\r\n        <h2 style={{ margin: 0 }}>邀请码管理</h2>\r\n        <button\r\n          onClick={() => modal.open()}\r\n          style={{ padding: '10px 20px', border: 'none', background: '#28a745', color: 'white', borderRadius: '4px', cursor: 'pointer', fontSize: '14px', fontWeight: '500' }}\r\n        >\r\n          创建邀请码\r\n        </button>\r\n      </div>\r\n\r\n      {/* 筛选器 */}\r\n      <div style={{ marginBottom: '20px', display: 'flex', gap: '10px', alignItems: 'center' }}>\r\n        <label style={{ fontWeight: 'bold' }}>状态筛选：</label>\r\n        <select\r\n          value={statusFilter}\r\n          onChange={(e) => handleStatusFilterChange(e.target.value)}\r\n          style={{ padding: '8px 12px', border: '1px solid #ddd', borderRadius: '4px', fontSize: '14px' }}\r\n        >\r\n          <option value=\"\">全部</option>\r\n          <option value=\"active\">启用</option>\r\n          <option value=\"inactive\">禁用</option>\r\n        </select>\r\n      </div>\r\n\r\n      {/* 表格 */}\r\n      <AdminTable\r\n        columns={columns}\r\n        data={table.data}\r\n        loading={table.loading}\r\n        rowKey=\"id\"\r\n        emptyText=\"暂无邀请码数据\"\r\n      />\r\n\r\n      {/* 分页 */}\r\n      <AdminPagination\r\n        currentPage={table.currentPage}\r\n        totalPages={table.totalPages}\r\n        total={table.total}\r\n        pageSize={table.pageSize}\r\n        onPageChange={table.setCurrentPage}\r\n        onPageSizeChange={table.setPageSize}\r\n      />\r\n\r\n      {/* 模态框 */}\r\n      <AdminModal\r\n        isOpen={modal.isOpen}\r\n        onClose={modal.close}\r\n        title={modal.isEdit ? '编辑邀请码' : '创建邀请码'}\r\n        footer={modalFooter}\r\n        width=\"600px\"\r\n      >\r\n        <div style={{ padding: '20px 0' }}>\r\n          <div style={{ marginBottom: '15px' }}>\r\n            <label style={{ display: 'block', marginBottom: '5px', fontWeight: 'bold' }}>\r\n              邀请码 <span style={{ color: 'red' }}>*</span>\r\n            </label>\r\n            <input\r\n              type=\"text\"\r\n              value={modal.formData.code}\r\n              onChange={(e) => modal.updateField('code', e.target.value.toUpperCase())}\r\n              disabled={modal.isEdit}\r\n              placeholder=\"请输入邀请码\"\r\n              style={{ width: '100%', padding: '8px', border: '1px solid #ddd', borderRadius: '4px' }}\r\n            />\r\n          </div>\r\n          <div style={{ marginBottom: '15px' }}>\r\n            <label style={{ display: 'block', marginBottom: '5px', fontWeight: 'bold' }}>名称</label>\r\n            <input\r\n              type=\"text\"\r\n              value={modal.formData.name}\r\n              onChange={(e) => modal.updateField('name', e.target.value)}\r\n              placeholder=\"请输入名称\"\r\n              style={{ width: '100%', padding: '8px', border: '1px solid #ddd', borderRadius: '4px' }}\r\n            />\r\n          </div>\r\n          <div style={{ marginBottom: '15px' }}>\r\n            <label style={{ display: 'block', marginBottom: '5px', fontWeight: 'bold' }}>\r\n              奖励类型 <span style={{ color: 'red' }}>*</span>\r\n            </label>\r\n            <select\r\n              value={modal.formData.reward_type}\r\n              onChange={(e) => modal.updateField('reward_type', e.target.value as FormData['reward_type'])}\r\n              style={{ width: '100%', padding: '8px', border: '1px solid #ddd', borderRadius: '4px' }}\r\n            >\r\n              <option value=\"points\">积分</option>\r\n              <option value=\"coupon\">优惠券</option>\r\n              <option value=\"both\">积分+优惠券</option>\r\n            </select>\r\n          </div>\r\n          {(modal.formData.reward_type === 'points' || modal.formData.reward_type === 'both') && (\r\n            <div style={{ marginBottom: '15px' }}>\r\n              <label style={{ display: 'block', marginBottom: '5px', fontWeight: 'bold' }}>积分奖励（分）</label>\r\n              <input\r\n                type=\"number\"\r\n                value={modal.formData.points_reward}\r\n                onChange={(e) => modal.updateField('points_reward', parseInt(e.target.value) || 0)}\r\n                placeholder=\"100分=1.00\"\r\n                min=\"0\"\r\n                style={{ width: '100%', padding: '8px', border: '1px solid #ddd', borderRadius: '4px' }}\r\n              />\r\n            </div>\r\n          )}\r\n          <div style={{ marginBottom: '15px' }}>\r\n            <label style={{ display: 'block', marginBottom: '5px', fontWeight: 'bold' }}>\r\n              有效期开始时间 <span style={{ color: 'red' }}>*</span>\r\n            </label>\r\n            <input\r\n              type=\"datetime-local\"\r\n              value={modal.formData.valid_from}\r\n              onChange={(e) => modal.updateField('valid_from', e.target.value)}\r\n              style={{ width: '100%', padding: '8px', border: '1px solid #ddd', borderRadius: '4px' }}\r\n            />\r\n          </div>\r\n          <div style={{ marginBottom: '15px' }}>\r\n            <label style={{ display: 'block', marginBottom: '5px', fontWeight: 'bold' }}>\r\n              有效期结束时间 <span style={{ color: 'red' }}>*</span>\r\n            </label>\r\n            <input\r\n              type=\"datetime-local\"\r\n              value={modal.formData.valid_until}\r\n              onChange={(e) => modal.updateField('valid_until', e.target.value)}\r\n              style={{ width: '100%', padding: '8px', border: '1px solid #ddd', borderRadius: '4px' }}\r\n            />\r\n          </div>\r\n          <div style={{ marginBottom: '15px' }}>\r\n            <label style={{ display: 'flex', alignItems: 'center', gap: '8px', cursor: 'pointer' }}>\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={modal.formData.is_active}\r\n                onChange={(e) => modal.updateField('is_active', e.target.checked)}\r\n              />\r\n              <span>启用状态</span>\r\n            </label>\r\n          </div>\r\n        </div>\r\n      </AdminModal>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InvitationManagement;\r\n"],"names":["initialForm","code","name","description","reward_type","points_reward","coupon_id","undefined","max_uses","valid_from","valid_until","is_active","InvitationManagement","statusFilter","setStatusFilter","useState","fetchCodes","useCallback","async","page","pageSize","filters","_ref","response","getInvitationCodes","limit","status","data","items","total","handleFetchError","error","message","getErrorMessage","table","useAdminTable","fetchData","initialPageSize","onError","modal","useModalForm","initialValues","onSubmit","values","isEdit","warning","Error","id","updateInvitationCode","Date","toISOString","success","createInvitationCode","refresh","handleEdit","detail","getInvitationCodeDetail","open","slice","handleDelete","window","confirm","deleteInvitationCode","then","catch","handleStatusFilterChange","setFilters","columns","key","title","dataIndex","width","render","value","_","record","concat","used_count","_jsxs","style","fontSize","children","toLocaleString","_jsx","StatusBadge","text","variant","align","display","gap","justifyContent","onClick","padding","border","background","color","borderRadius","cursor","modalFooter","close","handleSubmit","disabled","loading","opacity","alignItems","marginBottom","margin","fontWeight","onChange","e","target","AdminTable","rowKey","emptyText","AdminPagination","currentPage","totalPages","onPageChange","setCurrentPage","onPageSizeChange","setPageSize","AdminModal","isOpen","onClose","footer","type","formData","updateField","toUpperCase","placeholder","parseInt","min","checked"],"sourceRoot":""}