"use strict";(self.webpackChunklinku_admin=self.webpackChunklinku_admin||[]).push([[475],{5475(e,d,t){t.r(d),t.d(d,{default:()=>m});var i=t(5043),r=t(3216),n=t(9379),l=t(6204),o=t(446),s=t.n(o),a=t(638),p=t(6427),x=t(579);const c=[{key:"id",label:"ID"},{key:"title",label:"\u6807\u9898"},{key:"task_type",label:"\u7c7b\u578b"},{key:"location",label:"\u57ce\u5e02"},{key:"status",label:"\u72b6\u6001"},{key:"reward",label:"\u60ac\u8d4f",format:e=>"\xa3".concat(Number(e).toFixed(2))},{key:"created_at",label:"\u521b\u5efa\u65f6\u95f4",format:e=>s()(e).format("YYYY-MM-DD")}],h=["Housekeeping","Campus Life","Second-hand & Rental","Errand Running","Skill Service","Social Help","Transportation","Pet Care","Life Convenience","Other"],g=["Online","London","Edinburgh","Manchester","Birmingham","Glasgow","Bristol","Sheffield","Leeds","Nottingham","Newcastle","Southampton","Liverpool","Cardiff","Coventry","Exeter","Leicester","York","Aberdeen","Bath","Dundee","Reading","St Andrews","Belfast","Brighton","Durham","Norwich","Swansea","Loughborough","Lancaster","Warwick","Cambridge","Oxford","Other"],u=e=>{let{task:d,onClose:t}=e;const[r,n]=(0,i.useState)([]),[o,s]=(0,i.useState)(!1),p=d.is_multi_participant,c=()=>{s(!0),(0,l.qy)(d.id).then(e=>{n(e.participants||[])}).catch(()=>{}).finally(()=>{s(!1)})};(0,i.useEffect)(()=>{p&&c()},[d]);return(0,x.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1100},children:(0,x.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"20px",maxWidth:"600px",width:"90%",maxHeight:"80vh",overflow:"auto",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",paddingBottom:"10px",borderBottom:"1px solid #eee"},children:[(0,x.jsx)("h3",{style:{margin:0},children:"\u4efb\u52a1\u8be6\u60c5"}),(0,x.jsx)("button",{onClick:t,style:{padding:"6px 12px",border:"none",background:"#dc3545",color:"white",borderRadius:"4px",cursor:"pointer"},children:"\u5173\u95ed"})]}),(0,x.jsxs)("div",{style:{display:"grid",gap:"15px"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"\u6807\u9898\uff1a"}),(0,x.jsx)("div",{style:{marginTop:"5px",padding:"10px",backgroundColor:"#f8f9fa",borderRadius:"4px"},children:d.title})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"\u63cf\u8ff0\uff1a"}),(0,x.jsx)("div",{style:{marginTop:"5px",padding:"10px",backgroundColor:"#f8f9fa",borderRadius:"4px"},children:d.description})]}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"\u4efb\u52a1ID\uff1a"}),(0,x.jsx)("div",{style:{marginTop:"5px"},children:d.id})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"\u72b6\u6001\uff1a"}),(0,x.jsx)("div",{style:{marginTop:"5px"},children:d.status})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"\u7c7b\u578b\uff1a"}),(0,x.jsx)("div",{style:{marginTop:"5px"},children:d.task_type})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"\u5956\u52b1\uff1a"}),(0,x.jsxs)("div",{style:{marginTop:"5px"},children:["\xa3",d.reward.toFixed(2)]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"\u4f4d\u7f6e\uff1a"}),(0,x.jsx)("div",{style:{marginTop:"5px"},children:d.location})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"\u53d1\u5e03\u8005ID\uff1a"}),(0,x.jsx)("div",{style:{marginTop:"5px"},children:d.poster_id})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"\u63a5\u53d7\u8005ID\uff1a"}),(0,x.jsx)("div",{style:{marginTop:"5px"},children:d.taker_id||"\u672a\u63a5\u53d7"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"\u521b\u5efa\u65f6\u95f4\uff1a"}),(0,x.jsxs)("div",{style:{marginTop:"5px"},children:[a.IX.formatUtcToLocal(d.created_at,"YYYY-MM-DD HH:mm:ss","Europe/London")," (\u82f1\u56fd\u65f6\u95f4)"]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"\u622a\u6b62\u65f6\u95f4\uff1a"}),(0,x.jsxs)("div",{style:{marginTop:"5px"},children:[a.IX.formatUtcToLocal(d.deadline,"YYYY-MM-DD HH:mm:ss","Europe/London")," (\u82f1\u56fd\u65f6\u95f4)"]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"\u662f\u5426\u5df2\u652f\u4ed8\uff1a"}),(0,x.jsx)("div",{style:{marginTop:"5px"},children:d.is_paid?"\u662f":"\u5426"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"\u662f\u5426\u5df2\u786e\u8ba4\uff1a"}),(0,x.jsx)("div",{style:{marginTop:"5px"},children:d.is_confirmed?"\u662f":"\u5426"})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"\u4efb\u52a1\u7b49\u7ea7\uff1a"}),(0,x.jsx)("div",{style:{marginTop:"5px"},children:d.task_level})]}),null!==d.points_reward&&void 0!==d.points_reward&&d.points_reward>0&&(0,x.jsxs)("div",{children:[(0,x.jsx)("strong",{children:"\u5b8c\u6210\u5956\u52b1\u79ef\u5206\uff1a"}),(0,x.jsxs)("div",{style:{marginTop:"5px",color:"#28a745",fontWeight:"bold"},children:[d.points_reward.toLocaleString()," \u79ef\u5206"]})]})]}),p&&(0,x.jsxs)("div",{style:{marginTop:"20px",paddingTop:"15px",borderTop:"1px solid #eee"},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[(0,x.jsx)("strong",{children:"\u53c2\u4e0e\u8005\u7ba1\u7406"}),(0,x.jsx)("button",{onClick:async()=>{if(window.confirm("\u786e\u5b9a\u8981\u542f\u52a8\u6b64\u591a\u4eba\u4efb\u52a1\u5417\uff1f"))try{await(0,l.O6)(d.id),alert("\u4efb\u52a1\u5df2\u542f\u52a8")}catch(e){alert("\u64cd\u4f5c\u5931\u8d25")}},style:{padding:"4px 10px",border:"none",background:"#17a2b8",color:"white",borderRadius:"4px",cursor:"pointer",fontSize:"13px"},children:"\u542f\u52a8\u4efb\u52a1"})]}),o?(0,x.jsx)("div",{style:{textAlign:"center",padding:"10px",color:"#666"},children:"\u52a0\u8f7d\u53c2\u4e0e\u8005..."}):0===r.length?(0,x.jsx)("div",{style:{textAlign:"center",padding:"10px",color:"#999"},children:"\u6682\u65e0\u53c2\u4e0e\u8005"}):(0,x.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,x.jsx)("th",{style:{padding:"8px",border:"1px solid #ddd",textAlign:"left"},children:"\u7528\u6237ID"}),(0,x.jsx)("th",{style:{padding:"8px",border:"1px solid #ddd",textAlign:"left"},children:"\u72b6\u6001"}),(0,x.jsx)("th",{style:{padding:"8px",border:"1px solid #ddd",textAlign:"left"},children:"\u64cd\u4f5c"})]})}),(0,x.jsx)("tbody",{children:r.map(e=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{style:{padding:"8px",border:"1px solid #ddd"},children:e.user_id||e.id}),(0,x.jsx)("td",{style:{padding:"8px",border:"1px solid #ddd"},children:e.status||"-"}),(0,x.jsx)("td",{style:{padding:"8px",border:"1px solid #ddd"},children:(0,x.jsxs)("div",{style:{display:"flex",gap:"5px",flexWrap:"wrap"},children:["pending"===e.status&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\u786e\u5b9a\u8981\u6279\u51c6\u6b64\u53c2\u4e0e\u8005\u5417\uff1f"))try{await(0,l.Jx)(d.id,e),alert("\u53c2\u4e0e\u8005\u5df2\u6279\u51c6"),c()}catch(t){alert("\u64cd\u4f5c\u5931\u8d25")}})(e.id),style:{padding:"3px 8px",border:"none",background:"#28a745",color:"white",borderRadius:"3px",cursor:"pointer",fontSize:"12px"},children:"\u6279\u51c6"}),(0,x.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\u786e\u5b9a\u8981\u62d2\u7edd\u6b64\u53c2\u4e0e\u8005\u5417\uff1f"))try{await(0,l.xF)(d.id,e),alert("\u53c2\u4e0e\u8005\u5df2\u62d2\u7edd"),c()}catch(t){alert("\u64cd\u4f5c\u5931\u8d25")}})(e.id),style:{padding:"3px 8px",border:"none",background:"#dc3545",color:"white",borderRadius:"3px",cursor:"pointer",fontSize:"12px"},children:"\u62d2\u7edd"})]}),e.exit_requested&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\u786e\u5b9a\u8981\u6279\u51c6\u6b64\u9000\u51fa\u7533\u8bf7\u5417\uff1f"))try{await(0,l.xj)(d.id,e),alert("\u9000\u51fa\u7533\u8bf7\u5df2\u6279\u51c6"),c()}catch(t){alert("\u64cd\u4f5c\u5931\u8d25")}})(e.id),style:{padding:"3px 8px",border:"none",background:"#fd7e14",color:"white",borderRadius:"3px",cursor:"pointer",fontSize:"12px"},children:"\u6279\u51c6\u9000\u51fa"}),(0,x.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\u786e\u5b9a\u8981\u62d2\u7edd\u6b64\u9000\u51fa\u7533\u8bf7\u5417\uff1f"))try{await(0,l.dj)(d.id,e),alert("\u9000\u51fa\u7533\u8bf7\u5df2\u62d2\u7edd"),c()}catch(t){alert("\u64cd\u4f5c\u5931\u8d25")}})(e.id),style:{padding:"3px 8px",border:"none",background:"#6c757d",color:"white",borderRadius:"3px",cursor:"pointer",fontSize:"12px"},children:"\u62d2\u7edd\u9000\u51fa"})]})]})})]},e.id))})]})]})]})]})})},b=e=>{var d;let{task:t,onClose:r,onSave:o}=e;const[s,a]=(0,i.useState)({title:t.title,description:t.description,reward:t.reward,location:t.location,task_type:t.task_type,status:t.status,task_level:t.task_level}),[p,c]=(0,i.useState)((null===(d=t.points_reward)||void 0===d?void 0:d.toString())||""),[u,b]=(0,i.useState)(!1);return(0,x.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1100},children:(0,x.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"20px",maxWidth:"500px",width:"90%",maxHeight:"80vh",overflow:"auto",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",paddingBottom:"10px",borderBottom:"1px solid #eee"},children:[(0,x.jsx)("h3",{style:{margin:0},children:"\u7f16\u8f91\u4efb\u52a1"}),(0,x.jsx)("button",{onClick:r,style:{padding:"6px 12px",border:"none",background:"#dc3545",color:"white",borderRadius:"4px",cursor:"pointer"},children:"\u5173\u95ed"})]}),(0,x.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),await o(s),!u)try{b(!0);const e=""===p.trim()?null:parseInt(p)||null;await(0,l.hm)(t.id,e)}catch(d){alert("\u66f4\u65b0\u4efb\u52a1\u79ef\u5206\u5931\u8d25")}finally{b(!1)}},children:[(0,x.jsxs)("div",{style:{display:"grid",gap:"15px"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"\u6807\u9898\uff1a"}),(0,x.jsx)("input",{type:"text",value:s.title,onChange:e=>a(d=>(0,n.A)((0,n.A)({},d),{},{title:e.target.value})),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},required:!0})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"\u63cf\u8ff0\uff1a"}),(0,x.jsx)("textarea",{value:s.description,onChange:e=>a(d=>(0,n.A)((0,n.A)({},d),{},{description:e.target.value})),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",minHeight:"100px"},required:!0})]}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"\u5956\u52b1\uff1a"}),(0,x.jsx)("input",{type:"number",step:"0.01",value:s.reward,onChange:e=>a(d=>(0,n.A)((0,n.A)({},d),{},{reward:parseFloat(e.target.value)})),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},required:!0})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"\u57ce\u5e02\uff1a"}),(0,x.jsx)("select",{value:s.location,onChange:e=>a(d=>(0,n.A)((0,n.A)({},d),{},{location:e.target.value})),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},required:!0,children:g.map(e=>(0,x.jsx)("option",{value:e,children:e},e))})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"\u7c7b\u578b\uff1a"}),(0,x.jsx)("select",{value:s.task_type,onChange:e=>a(d=>(0,n.A)((0,n.A)({},d),{},{task_type:e.target.value})),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},children:h.map(e=>(0,x.jsx)("option",{value:e,children:e},e))})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"\u72b6\u6001\uff1a"}),(0,x.jsxs)("select",{value:s.status,onChange:e=>a(d=>(0,n.A)((0,n.A)({},d),{},{status:e.target.value})),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},children:[(0,x.jsx)("option",{value:"open",children:"\u5f00\u653e"}),(0,x.jsx)("option",{value:"taken",children:"\u5df2\u63a5\u53d7"}),(0,x.jsx)("option",{value:"in_progress",children:"\u8fdb\u884c\u4e2d"}),(0,x.jsx)("option",{value:"completed",children:"\u5df2\u5b8c\u6210"}),(0,x.jsx)("option",{value:"cancelled",children:"\u5df2\u53d6\u6d88"})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"\u7b49\u7ea7\uff1a"}),(0,x.jsxs)("select",{value:s.task_level,onChange:e=>a(d=>(0,n.A)((0,n.A)({},d),{},{task_level:e.target.value})),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},children:[(0,x.jsx)("option",{value:"normal",children:"\u666e\u901a"}),(0,x.jsx)("option",{value:"vip",children:"VIP"}),(0,x.jsx)("option",{value:"super",children:"\u8d85\u7ea7VIP"})]})]})]}),(0,x.jsxs)("div",{style:{padding:"15px",background:"#f8f9fa",borderRadius:"6px",border:"1px solid #e9ecef"},children:[(0,x.jsx)("div",{style:{fontWeight:"bold",marginBottom:"8px",color:"#28a745"},children:"\u2b50 \u4efb\u52a1\u5b8c\u6210\u5956\u52b1\u79ef\u5206"}),(0,x.jsxs)("div",{style:{fontSize:"13px",color:"#666",marginBottom:"10px"},children:["\u8bbe\u7f6e\u6b64\u4efb\u52a1\u5b8c\u6210\u65f6\u7684\u5956\u52b1\u79ef\u5206\u3002\u7559\u7a7a\u62160\u8868\u793a\u4f7f\u7528\u7cfb\u7edf\u9ed8\u8ba4\u503c\uff08",null===t.points_reward||void 0===t.points_reward?"\u7cfb\u7edf\u9ed8\u8ba4":"".concat(t.points_reward,"\u79ef\u5206"),"\uff09"]}),(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,x.jsx)("input",{type:"number",value:p,onChange:e=>c(e.target.value),placeholder:"\u7559\u7a7a\u4f7f\u7528\u7cfb\u7edf\u9ed8\u8ba4\u503c",style:{flex:1,padding:"8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px"},min:"0",step:"100"}),(0,x.jsx)("span",{style:{color:"#666",fontSize:"13px"},children:"\u79ef\u5206"})]})]})]}),(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px",paddingTop:"15px",borderTop:"1px solid #eee"},children:[(0,x.jsx)("button",{type:"button",onClick:r,style:{padding:"8px 16px",border:"1px solid #ddd",background:"white",borderRadius:"4px",cursor:"pointer"},children:"\u53d6\u6d88"}),(0,x.jsx)("button",{type:"submit",style:{padding:"8px 16px",border:"none",background:"#28a745",color:"white",borderRadius:"4px",cursor:"pointer"},children:"\u4fdd\u5b58"})]})]})]})})},y=e=>{let{onClose:d,onSave:t}=e;const[r,l]=(0,i.useState)({status:"",task_level:""});return(0,x.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1100},children:(0,x.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"20px",maxWidth:"400px",width:"90%",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",paddingBottom:"10px",borderBottom:"1px solid #eee"},children:[(0,x.jsx)("h3",{style:{margin:0},children:"\u6279\u91cf\u66f4\u65b0"}),(0,x.jsx)("button",{onClick:d,style:{padding:"6px 12px",border:"none",background:"#dc3545",color:"white",borderRadius:"4px",cursor:"pointer"},children:"\u5173\u95ed"})]}),(0,x.jsxs)("form",{onSubmit:e=>{e.preventDefault();const d=Object.fromEntries(Object.entries(r).filter(e=>{let[d,t]=e;return""!==t}));0!==Object.keys(d).length?t(d):alert("\u8bf7\u81f3\u5c11\u9009\u62e9\u4e00\u4e2a\u8981\u66f4\u65b0\u7684\u5b57\u6bb5")},children:[(0,x.jsxs)("div",{style:{display:"grid",gap:"15px"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"\u72b6\u6001\uff1a"}),(0,x.jsxs)("select",{value:r.status,onChange:e=>l(d=>(0,n.A)((0,n.A)({},d),{},{status:e.target.value})),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},children:[(0,x.jsx)("option",{value:"",children:"\u4e0d\u66f4\u65b0"}),(0,x.jsx)("option",{value:"open",children:"\u5f00\u653e"}),(0,x.jsx)("option",{value:"taken",children:"\u5df2\u63a5\u53d7"}),(0,x.jsx)("option",{value:"in_progress",children:"\u8fdb\u884c\u4e2d"}),(0,x.jsx)("option",{value:"completed",children:"\u5df2\u5b8c\u6210"}),(0,x.jsx)("option",{value:"cancelled",children:"\u5df2\u53d6\u6d88"})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"\u7b49\u7ea7\uff1a"}),(0,x.jsxs)("select",{value:r.task_level,onChange:e=>l(d=>(0,n.A)((0,n.A)({},d),{},{task_level:e.target.value})),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},children:[(0,x.jsx)("option",{value:"",children:"\u4e0d\u66f4\u65b0"}),(0,x.jsx)("option",{value:"low",children:"\u4f4e"}),(0,x.jsx)("option",{value:"medium",children:"\u4e2d"}),(0,x.jsx)("option",{value:"high",children:"\u9ad8"})]})]})]}),(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px",paddingTop:"15px",borderTop:"1px solid #eee"},children:[(0,x.jsx)("button",{type:"button",onClick:d,style:{padding:"8px 16px",border:"1px solid #ddd",background:"white",borderRadius:"4px",cursor:"pointer"},children:"\u53d6\u6d88"}),(0,x.jsx)("button",{type:"submit",style:{padding:"8px 16px",border:"none",background:"#28a745",color:"white",borderRadius:"4px",cursor:"pointer"},children:"\u66f4\u65b0"})]})]})]})})},j=e=>{let{onClose:d}=e;const[t,r]=(0,i.useState)([]),[o,j]=(0,i.useState)(!1),[m,f]=(0,i.useState)([]),[v,k]=(0,i.useState)(!1),[w,C]=(0,i.useState)(null),[R,S]=(0,i.useState)(!1),[A,_]=(0,i.useState)(!1),[T,B]=(0,i.useState)({status:"",task_type:"",location:"",keyword:""}),[I,Y]=(0,i.useState)({skip:0,limit:20,total:0}),D=async()=>{try{j(!0);const e=await(0,l.Yj)((0,n.A)({skip:I.skip,limit:I.limit},T));r(e.tasks||[]),Y(d=>(0,n.A)((0,n.A)({},d),{},{total:e.total||0}))}catch(e){}finally{j(!1)}};(0,i.useEffect)(()=>{D()},[I.skip,I.limit,T]);const z=e=>{switch(e){case"open":return"#28a745";case"taken":return"#ffc107";case"in_progress":return"#17a2b8";case"completed":return"#6f42c1";case"cancelled":return"#dc3545";default:return"#6c757d"}},L=e=>{switch(e){case"open":return"\u5f00\u653e";case"taken":return"\u5df2\u63a5\u53d7";case"in_progress":return"\u8fdb\u884c\u4e2d";case"completed":return"\u5df2\u5b8c\u6210";case"cancelled":return"\u5df2\u53d6\u6d88";default:return e}};return(0,x.jsxs)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:[(0,x.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"20px",maxWidth:"1200px",width:"95%",maxHeight:"90vh",overflow:"auto",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",paddingBottom:"10px",borderBottom:"1px solid #eee"},children:[(0,x.jsx)("h2",{style:{margin:0,color:"#333"},children:"\u4efb\u52a1\u7ba1\u7406"}),(0,x.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[(0,x.jsx)("button",{onClick:()=>{(0,p.G)(t,"tasks-".concat(s()().format("YYYY-MM-DD")),c)},disabled:0===t.length,style:{padding:"8px 16px",border:"1px solid #52c41a",background:"white",color:"#52c41a",borderRadius:"4px",cursor:"pointer",fontSize:"14px"},children:"\u5bfc\u51fa CSV"}),(0,x.jsx)("button",{onClick:d,style:{padding:"8px 16px",border:"none",background:"#dc3545",color:"white",borderRadius:"4px",cursor:"pointer"},children:"\u5173\u95ed"})]})]}),(0,x.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"10px",marginBottom:"20px",padding:"15px",backgroundColor:"#f8f9fa",borderRadius:"6px"},children:[(0,x.jsxs)("select",{value:T.status,onChange:e=>B(d=>(0,n.A)((0,n.A)({},d),{},{status:e.target.value})),style:{padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},children:[(0,x.jsx)("option",{value:"",children:"\u5168\u90e8\u72b6\u6001"}),(0,x.jsx)("option",{value:"open",children:"\u5f00\u653e"}),(0,x.jsx)("option",{value:"taken",children:"\u5df2\u63a5\u53d7"}),(0,x.jsx)("option",{value:"in_progress",children:"\u8fdb\u884c\u4e2d"}),(0,x.jsx)("option",{value:"completed",children:"\u5df2\u5b8c\u6210"}),(0,x.jsx)("option",{value:"cancelled",children:"\u5df2\u53d6\u6d88"})]}),(0,x.jsxs)("select",{value:T.task_type,onChange:e=>B(d=>(0,n.A)((0,n.A)({},d),{},{task_type:e.target.value})),style:{padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},children:[(0,x.jsx)("option",{value:"",children:"\u5168\u90e8\u7c7b\u578b"}),h.map(e=>(0,x.jsx)("option",{value:e,children:e},e))]}),(0,x.jsxs)("select",{value:T.location,onChange:e=>B(d=>(0,n.A)((0,n.A)({},d),{},{location:e.target.value})),style:{padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},children:[(0,x.jsx)("option",{value:"",children:"\u5168\u90e8\u57ce\u5e02"}),g.map(e=>(0,x.jsx)("option",{value:e,children:e},e))]}),(0,x.jsx)("input",{type:"text",placeholder:"\u641c\u7d22\u5173\u952e\u8bcd...",value:T.keyword,onChange:e=>B(d=>(0,n.A)((0,n.A)({},d),{},{keyword:e.target.value})),style:{padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]}),m.length>0&&(0,x.jsxs)("div",{style:{display:"flex",gap:"10px",marginBottom:"20px",padding:"10px",backgroundColor:"#e3f2fd",borderRadius:"6px"},children:[(0,x.jsxs)("span",{children:["\u5df2\u9009\u62e9 ",m.length," \u4e2a\u4efb\u52a1"]}),(0,x.jsx)("button",{onClick:()=>_(!0),style:{padding:"6px 12px",border:"none",background:"#2196f3",color:"white",borderRadius:"4px",cursor:"pointer"},children:"\u6279\u91cf\u66f4\u65b0"}),(0,x.jsx)("button",{onClick:async()=>{if(window.confirm("\u786e\u5b9a\u8981\u5220\u9664\u9009\u4e2d\u7684 ".concat(m.length," \u4e2a\u4efb\u52a1\u5417\uff1f")))try{const e=await(0,l.Pw)(m);alert(e.message),f([]),await D()}catch(e){alert("\u6279\u91cf\u5220\u9664\u5931\u8d25")}},style:{padding:"6px 12px",border:"none",background:"#f44336",color:"white",borderRadius:"4px",cursor:"pointer"},children:"\u6279\u91cf\u5220\u9664"})]}),(0,x.jsx)("div",{style:{overflow:"auto",maxHeight:"500px"},children:o?(0,x.jsx)("div",{style:{textAlign:"center",padding:"20px"},children:"\u52a0\u8f7d\u4e2d..."}):0===t.length?(0,x.jsx)("div",{style:{textAlign:"center",padding:"20px",color:"#666"},children:"\u6682\u65e0\u4efb\u52a1"}):(0,x.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{style:{backgroundColor:"#f8f9fa"},children:[(0,x.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:(0,x.jsx)("input",{type:"checkbox",checked:m.length===t.length&&t.length>0,onChange:()=>{m.length===t.length?f([]):f(t.map(e=>e.id))}})}),(0,x.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"ID"}),(0,x.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"\u6807\u9898"}),(0,x.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"\u7c7b\u578b"}),(0,x.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"\u72b6\u6001"}),(0,x.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"\u5956\u52b1"}),(0,x.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"\u4f4d\u7f6e"}),(0,x.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"\u521b\u5efa\u65f6\u95f4"}),(0,x.jsx)("th",{style:{padding:"10px",border:"1px solid #ddd",textAlign:"left"},children:"\u64cd\u4f5c"})]})}),(0,x.jsx)("tbody",{children:t.map(e=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:(0,x.jsx)("input",{type:"checkbox",checked:m.includes(e.id),onChange:()=>{return d=e.id,void f(e=>e.includes(d)?e.filter(e=>e!==d):[...e,d]);var d}})}),(0,x.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.id}),(0,x.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:(0,x.jsx)("div",{style:{maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.title})}),(0,x.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.task_type}),(0,x.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:(0,x.jsx)("span",{style:{padding:"4px 8px",borderRadius:"4px",color:"white",backgroundColor:z(e.status),fontSize:"12px"},children:L(e.status)})}),(0,x.jsxs)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:["\xa3",e.reward.toFixed(2)]}),(0,x.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:e.location}),(0,x.jsxs)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:[a.IX.formatUtcToLocal(e.created_at,"YYYY-MM-DD HH:mm","Europe/London")," (\u82f1\u56fd\u65f6\u95f4)"]}),(0,x.jsx)("td",{style:{padding:"10px",border:"1px solid #ddd"},children:(0,x.jsxs)("div",{style:{display:"flex",gap:"5px"},children:[(0,x.jsx)("button",{onClick:()=>(async e=>{try{const d=await(0,l.sk)(e);C(d.task),k(!0)}catch(d){}})(e.id),style:{padding:"4px 8px",border:"none",background:"#17a2b8",color:"white",borderRadius:"3px",cursor:"pointer",fontSize:"12px"},children:"\u67e5\u770b"}),(0,x.jsx)("button",{onClick:()=>(e=>{C(e),S(!0)})(e),style:{padding:"4px 8px",border:"none",background:"#28a745",color:"white",borderRadius:"3px",cursor:"pointer",fontSize:"12px"},children:"\u7f16\u8f91"}),"cancelled"!==e.status&&"completed"!==e.status&&(0,x.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\u786e\u5b9a\u8981\u53d6\u6d88\u6b64\u4efb\u52a1\u5417\uff1f\u6b64\u64cd\u4f5c\u5c06\u901a\u77e5\u6240\u6709\u53c2\u4e0e\u8005\u3002"))try{await(0,l.Or)(e,{status:"cancelled"}),await D(),alert("\u4efb\u52a1\u5df2\u53d6\u6d88")}catch(d){alert("\u53d6\u6d88\u4efb\u52a1\u5931\u8d25")}})(e.id),style:{padding:"4px 8px",border:"none",background:"#fd7e14",color:"white",borderRadius:"3px",cursor:"pointer",fontSize:"12px"},children:"\u53d6\u6d88"}),(0,x.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("\u786e\u5b9a\u8981\u5220\u9664\u6b64\u4efb\u52a1\u5417\uff1f\u6b64\u64cd\u4f5c\u4e0d\u53ef\u6062\u590d\uff01"))try{await(0,l.WK)(e),await D(),alert("\u4efb\u52a1\u5df2\u5220\u9664")}catch(d){alert("\u5220\u9664\u4efb\u52a1\u5931\u8d25")}})(e.id),style:{padding:"4px 8px",border:"none",background:"#dc3545",color:"white",borderRadius:"3px",cursor:"pointer",fontSize:"12px"},children:"\u5220\u9664"})]})})]},e.id))})]})}),(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"20px",paddingTop:"10px",borderTop:"1px solid #eee"},children:[(0,x.jsxs)("div",{children:["\u663e\u793a ",I.skip+1," - ",Math.min(I.skip+I.limit,I.total)," \u6761\uff0c \u5171 ",I.total," \u6761"]}),(0,x.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,x.jsx)("button",{onClick:()=>Y(e=>(0,n.A)((0,n.A)({},e),{},{skip:Math.max(0,e.skip-e.limit)})),disabled:0===I.skip,style:{padding:"6px 12px",border:"1px solid #ddd",background:0===I.skip?"#f8f9fa":"white",cursor:0===I.skip?"not-allowed":"pointer",borderRadius:"4px"},children:"\u4e0a\u4e00\u9875"}),(0,x.jsx)("button",{onClick:()=>Y(e=>(0,n.A)((0,n.A)({},e),{},{skip:e.skip+e.limit})),disabled:I.skip+I.limit>=I.total,style:{padding:"6px 12px",border:"1px solid #ddd",background:I.skip+I.limit>=I.total?"#f8f9fa":"white",cursor:I.skip+I.limit>=I.total?"not-allowed":"pointer",borderRadius:"4px"},children:"\u4e0b\u4e00\u9875"})]})]})]}),v&&w&&(0,x.jsx)(u,{task:w,onClose:()=>k(!1)}),R&&w&&(0,x.jsx)(b,{task:w,onClose:()=>S(!1),onSave:async e=>{try{await(0,l.Or)(w.id,e),await D(),S(!1),alert("\u4efb\u52a1\u66f4\u65b0\u6210\u529f")}catch(d){alert("\u66f4\u65b0\u4efb\u52a1\u5931\u8d25")}}}),A&&(0,x.jsx)(y,{onClose:()=>_(!1),onSave:async e=>{try{const d=await(0,l.bB)(m,e);alert(d.message),f([]),_(!1),await D()}catch(d){alert("\u6279\u91cf\u66f4\u65b0\u5931\u8d25")}}})]})},m=()=>{const e=(0,r.Zp)();return(0,x.jsx)(j,{onClose:()=>e("/admin")})}},6427(e,d,t){function i(e,d,t){const i=[t.map(e=>'"'.concat(e.label,'"')).join(","),...e.map(e=>t.map(d=>{const t=d.format?d.format(e[d.key],e):e[d.key],i=null==t?"":String(t);return'"'.concat(i.replace(/"/g,'""'),'"')}).join(","))].join("\r\n"),r=new Blob(["\ufeff"+i],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(r),l=document.createElement("a");l.href=n,l.download="".concat(d,".csv"),document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(n)}t.d(d,{G:()=>i})}}]);
//# sourceMappingURL=475.1f4820bc.chunk.js.map