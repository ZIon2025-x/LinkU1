{"version":3,"file":"static/js/232.c3e2a621.chunk.js","mappings":"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","sources":["pages/admin/forum/ForumManagement.tsx"],"sourcesContent":["import React, { useCallback } from 'react';\r\nimport { message, Modal } from 'antd';\r\nimport { useAdminTable, useModalForm } from '../../../hooks';\r\nimport { AdminTable, AdminPagination, StatusBadge, Column } from '../../../components/admin';\r\nimport {\r\n  getForumCategories,\r\n  createForumCategory,\r\n  updateForumCategory,\r\n  deleteForumCategory\r\n} from '../../../api';\r\nimport { getErrorMessage } from '../../../utils/errorHandler';\r\n\r\ninterface Category {\r\n  id: number;\r\n  name: string;\r\n  description?: string;\r\n  sort_order: number;\r\n  is_active: boolean;\r\n  post_count?: number;\r\n}\r\n\r\ninterface CategoryForm {\r\n  id?: number;\r\n  name: string;\r\n  description: string;\r\n  sort_order: number;\r\n  is_active: boolean;\r\n}\r\n\r\nconst initialForm: CategoryForm = {\r\n  name: '',\r\n  description: '',\r\n  sort_order: 0,\r\n  is_active: true\r\n};\r\n\r\n/**\r\n * 论坛分类管理组件\r\n */\r\nconst ForumManagement: React.FC = () => {\r\n  const fetchCategories = useCallback(async () => {\r\n    const response = await getForumCategories();\r\n    const data = response.categories || response.items || [];\r\n    return { data, total: data.length };\r\n  }, []);\r\n\r\n  const handleFetchError = useCallback((error: any) => {\r\n    message.error(getErrorMessage(error));\r\n  }, []);\r\n\r\n  const table = useAdminTable<Category>({\r\n    fetchData: fetchCategories,\r\n    initialPageSize: 100,\r\n    onError: handleFetchError,\r\n  });\r\n\r\n  const modal = useModalForm<CategoryForm>({\r\n    initialValues: initialForm,\r\n    onSubmit: async (values, isEdit) => {\r\n      if (!values.name) {\r\n        message.warning('请填写分类名称');\r\n        throw new Error('分类名称不能为空');\r\n      }\r\n      if (isEdit && values.id) {\r\n        await updateForumCategory(values.id, {\r\n          name: values.name,\r\n          description: values.description || undefined,\r\n          sort_order: values.sort_order,\r\n          is_visible: values.is_active\r\n        });\r\n        message.success('分类更新成功！');\r\n      } else {\r\n        await createForumCategory({\r\n          name: values.name,\r\n          description: values.description || undefined,\r\n          sort_order: values.sort_order,\r\n          is_visible: values.is_active\r\n        });\r\n        message.success('分类创建成功！');\r\n      }\r\n      table.refresh();\r\n    },\r\n    onError: (error) => {\r\n      message.error(getErrorMessage(error));\r\n    },\r\n  });\r\n\r\n  const handleEdit = (category: Category) => {\r\n    modal.open({\r\n      id: category.id,\r\n      name: category.name,\r\n      description: category.description || '',\r\n      sort_order: category.sort_order,\r\n      is_active: category.is_active\r\n    });\r\n  };\r\n\r\n  const handleDelete = (id: number) => {\r\n    Modal.confirm({\r\n      title: '确认删除',\r\n      content: '确定要删除这个分类吗？删除后该分类下的帖子将无法访问。',\r\n      okText: '确定',\r\n      cancelText: '取消',\r\n      okButtonProps: { danger: true },\r\n      onOk: async () => {\r\n        try {\r\n          await deleteForumCategory(id);\r\n          message.success('分类删除成功！');\r\n          table.refresh();\r\n        } catch (error: any) {\r\n          message.error(getErrorMessage(error));\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  const columns: Column<Category>[] = [\r\n    {\r\n      key: 'id',\r\n      title: 'ID',\r\n      dataIndex: 'id',\r\n      width: 80,\r\n    },\r\n    {\r\n      key: 'name',\r\n      title: '名称',\r\n      dataIndex: 'name',\r\n      width: 200,\r\n      render: (value) => <strong>{value}</strong>,\r\n    },\r\n    {\r\n      key: 'description',\r\n      title: '描述',\r\n      dataIndex: 'description',\r\n      width: 250,\r\n      render: (value) => (\r\n        <span style={{ maxWidth: 250, overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap', display: 'block' }}>\r\n          {value || '-'}\r\n        </span>\r\n      ),\r\n    },\r\n    {\r\n      key: 'post_count',\r\n      title: '帖子数',\r\n      dataIndex: 'post_count',\r\n      width: 100,\r\n      render: (value) => value || 0,\r\n    },\r\n    {\r\n      key: 'sort_order',\r\n      title: '排序',\r\n      dataIndex: 'sort_order',\r\n      width: 80,\r\n    },\r\n    {\r\n      key: 'is_active',\r\n      title: '状态',\r\n      dataIndex: 'is_active',\r\n      width: 100,\r\n      render: (value) => (\r\n        <StatusBadge\r\n          text={value ? '启用' : '禁用'}\r\n          variant={value ? 'success' : 'danger'}\r\n        />\r\n      ),\r\n    },\r\n    {\r\n      key: 'actions',\r\n      title: '操作',\r\n      width: 150,\r\n      align: 'center',\r\n      render: (_, record) => (\r\n        <div style={{ display: 'flex', gap: '8px', justifyContent: 'center' }}>\r\n          <button\r\n            onClick={() => handleEdit(record)}\r\n            style={{\r\n              padding: '4px 8px',\r\n              border: '1px solid #007bff',\r\n              background: 'white',\r\n              color: '#007bff',\r\n              borderRadius: '4px',\r\n              cursor: 'pointer',\r\n              fontSize: '12px'\r\n            }}\r\n          >\r\n            编辑\r\n          </button>\r\n          <button\r\n            onClick={() => handleDelete(record.id)}\r\n            style={{\r\n              padding: '4px 8px',\r\n              border: '1px solid #dc3545',\r\n              background: 'white',\r\n              color: '#dc3545',\r\n              borderRadius: '4px',\r\n              cursor: 'pointer',\r\n              fontSize: '12px'\r\n            }}\r\n          >\r\n            删除\r\n          </button>\r\n        </div>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <div>\r\n      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>\r\n        <h2 style={{ margin: 0 }}>论坛分类管理</h2>\r\n        <button\r\n          onClick={() => modal.open(initialForm, true)}\r\n          style={{\r\n            padding: '10px 20px',\r\n            border: 'none',\r\n            background: '#28a745',\r\n            color: 'white',\r\n            borderRadius: '4px',\r\n            cursor: 'pointer',\r\n            fontSize: '14px',\r\n            fontWeight: '500'\r\n          }}\r\n        >\r\n          创建分类\r\n        </button>\r\n      </div>\r\n\r\n      <AdminTable\r\n        columns={columns}\r\n        data={table.data}\r\n        loading={table.loading}\r\n        rowKey=\"id\"\r\n        emptyText=\"暂无分类\"\r\n      />\r\n\r\n      {table.total > table.pageSize && (\r\n        <AdminPagination\r\n          currentPage={table.currentPage}\r\n          totalPages={table.totalPages}\r\n          total={table.total}\r\n          pageSize={table.pageSize}\r\n          onPageChange={table.setCurrentPage}\r\n          onPageSizeChange={table.setPageSize}\r\n        />\r\n      )}\r\n\r\n      {/* 创建/编辑模态框 */}\r\n      <Modal\r\n        title={modal.isEdit ? '编辑分类' : '创建分类'}\r\n        open={modal.isOpen}\r\n        onCancel={modal.close}\r\n        onOk={modal.handleSubmit}\r\n        confirmLoading={modal.loading}\r\n        okText={modal.isEdit ? '更新' : '创建'}\r\n        cancelText=\"取消\"\r\n        width={500}\r\n      >\r\n        <div style={{ padding: '20px 0' }}>\r\n          <div style={{ marginBottom: '15px' }}>\r\n            <label style={{ display: 'block', marginBottom: '5px', fontWeight: 'bold' }}>\r\n              分类名称 <span style={{ color: 'red' }}>*</span>\r\n            </label>\r\n            <input\r\n              type=\"text\"\r\n              value={modal.formData.name}\r\n              onChange={(e) => modal.updateField('name', e.target.value)}\r\n              placeholder=\"请输入分类名称\"\r\n              style={{\r\n                width: '100%',\r\n                padding: '8px',\r\n                border: '1px solid #ddd',\r\n                borderRadius: '4px',\r\n                boxSizing: 'border-box'\r\n              }}\r\n            />\r\n          </div>\r\n          <div style={{ marginBottom: '15px' }}>\r\n            <label style={{ display: 'block', marginBottom: '5px', fontWeight: 'bold' }}>描述</label>\r\n            <textarea\r\n              value={modal.formData.description}\r\n              onChange={(e) => modal.updateField('description', e.target.value)}\r\n              placeholder=\"请输入分类描述（可选）\"\r\n              rows={3}\r\n              style={{\r\n                width: '100%',\r\n                padding: '8px',\r\n                border: '1px solid #ddd',\r\n                borderRadius: '4px',\r\n                resize: 'vertical',\r\n                boxSizing: 'border-box'\r\n              }}\r\n            />\r\n          </div>\r\n          <div style={{ marginBottom: '15px' }}>\r\n            <label style={{ display: 'block', marginBottom: '5px', fontWeight: 'bold' }}>\r\n              排序（数字越小越靠前）\r\n            </label>\r\n            <input\r\n              type=\"number\"\r\n              value={modal.formData.sort_order}\r\n              onChange={(e) => modal.updateField('sort_order', parseInt(e.target.value) || 0)}\r\n              style={{\r\n                width: '100%',\r\n                padding: '8px',\r\n                border: '1px solid #ddd',\r\n                borderRadius: '4px',\r\n                boxSizing: 'border-box'\r\n              }}\r\n            />\r\n          </div>\r\n          <div style={{ marginBottom: '15px' }}>\r\n            <label style={{ display: 'flex', alignItems: 'center', gap: '8px', cursor: 'pointer' }}>\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={modal.formData.is_active}\r\n                onChange={(e) => modal.updateField('is_active', e.target.checked)}\r\n              />\r\n              <span>启用状态</span>\r\n            </label>\r\n          </div>\r\n        </div>\r\n      </Modal>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ForumManagement;\r\n"],"names":["initialForm","name","description","sort_order","is_active","ForumManagement","fetchCategories","useCallback","async","response","getForumCategories","data","categories","items","total","length","handleFetchError","error","message","getErrorMessage","table","useAdminTable","fetchData","initialPageSize","onError","modal","useModalForm","initialValues","onSubmit","values","isEdit","warning","Error","id","updateForumCategory","undefined","is_visible","success","createForumCategory","refresh","columns","key","title","dataIndex","width","render","value","_jsx","children","style","maxWidth","overflow","textOverflow","whiteSpace","display","StatusBadge","text","variant","align","_","record","_jsxs","gap","justifyContent","onClick","handleEdit","category","open","padding","border","background","color","borderRadius","cursor","fontSize","handleDelete","Modal","confirm","content","okText","cancelText","okButtonProps","danger","onOk","deleteForumCategory","alignItems","marginBottom","margin","fontWeight","AdminTable","loading","rowKey","emptyText","pageSize","AdminPagination","currentPage","totalPages","onPageChange","setCurrentPage","onPageSizeChange","setPageSize","isOpen","onCancel","close","handleSubmit","confirmLoading","type","formData","onChange","e","updateField","target","placeholder","boxSizing","rows","resize","parseInt","checked"],"sourceRoot":""}