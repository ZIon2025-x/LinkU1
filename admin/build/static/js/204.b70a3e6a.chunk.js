"use strict";(self.webpackChunklinku_admin=self.webpackChunklinku_admin||[]).push([[204],{4991(e,t,d){d.r(t),d.d(t,{default:()=>x});var i=d(9379),a=d(5043),r=d(4400),o=d(5580),n=d(8075),l=d(6204),s=d(3028),p=d(579);const c={name:"",description:"",image_url:"",leaderboard_id:""},x=()=>{const[e,t]=(0,a.useState)("items"),[d,x]=(0,a.useState)({}),u=(0,a.useCallback)(async e=>{let{page:t,pageSize:a}=e;const r=(await(0,l.ur)((0,i.A)({offset:(t-1)*a,limit:a},d))).items||[];return{data:r,total:r.length<a?(t-1)*a+r.length:t*a+1}},[d]),g=(0,o.Dp)({fetchData:u,initialPageSize:50,onError:e=>r.Ay.error((0,s.u1)(e))}),h=(0,a.useCallback)(async e=>{let{page:t,pageSize:d}=e;const i=await(0,l.fB)({offset:(t-1)*d,limit:d});return{data:i.items||[],total:i.total||0}},[]),y=(0,o.Dp)({fetchData:h,initialPageSize:20,onError:e=>r.Ay.error((0,s.u1)(e))}),b=(0,o.Fb)({initialValues:c,onSubmit:async(e,t)=>{if(!e.name)throw r.Ay.warning("\u8bf7\u586b\u5199\u7ade\u54c1\u540d\u79f0"),new Error("validation");const d={name:e.name,description:e.description||void 0,image_url:e.image_url||void 0,leaderboard_id:""!==e.leaderboard_id?Number(e.leaderboard_id):void 0};t&&e.id?(await(0,l.HC)(e.id,d),r.Ay.success("\u7ade\u54c1\u66f4\u65b0\u6210\u529f")):(await(0,l.OH)(d),r.Ay.success("\u7ade\u54c1\u521b\u5efa\u6210\u529f")),y.refresh()},onError:e=>{"validation"!==(null===e||void 0===e?void 0:e.message)&&r.Ay.error((0,s.u1)(e))}}),m=(0,a.useCallback)(async e=>{let{page:t,pageSize:d}=e;const i=await(0,l.zw)({status:"pending",offset:(t-1)*d,limit:d});return{data:i.items||[],total:i.total||(i.items||[]).length}},[]),f=(0,o.Dp)({fetchData:m,initialPageSize:20,onError:e=>r.Ay.error((0,s.u1)(e))}),w=(0,a.useCallback)(e=>{window.confirm("\u786e\u5b9a\u8981\u5220\u9664\u8fd9\u4e2a\u7ade\u54c1\u5417\uff1f")&&(0,l.Jo)(e).then(()=>{r.Ay.success("\u7ade\u54c1\u5220\u9664\u6210\u529f"),y.refresh()}).catch(e=>r.Ay.error((0,s.u1)(e)))},[y]),v=(0,a.useCallback)(async(e,t)=>{try{await(0,l.Vu)(e,t),r.Ay.success("approve"===t?"\u5df2\u6279\u51c6":"\u5df2\u62d2\u7edd"),f.refresh()}catch(d){r.Ay.error((0,s.u1)(d))}},[f]),j=[{key:"id",title:"ID",dataIndex:"id",width:60},{key:"item_id",title:"\u7ade\u54c1ID",dataIndex:"item_id",width:80},{key:"user_id",title:"\u7528\u6237ID",width:100,render:(e,t)=>t.is_anonymous?(0,p.jsx)("span",{style:{color:"#999",fontStyle:"italic"},children:"\u533f\u540d"}):(0,p.jsx)(p.Fragment,{children:t.user_id})},{key:"vote_type",title:"\u6295\u7968\u7c7b\u578b",dataIndex:"vote_type",width:100,render:e=>(0,p.jsx)("span",{style:{padding:"4px 8px",borderRadius:"4px",background:"upvote"===e?"#52c41a":"#ff4d4f",color:"white",fontSize:"12px"},children:"upvote"===e?"\ud83d\udc4d \u70b9\u8d5e":"\ud83d\udc4e \u70b9\u8e29"})},{key:"comment",title:"\u7559\u8a00",width:300,render:(e,t)=>t.comment||(0,p.jsx)("span",{style:{color:"#999",fontStyle:"italic"},children:"\uff08\u65e0\u7559\u8a00\uff09"})},{key:"is_anonymous",title:"\u533f\u540d",dataIndex:"is_anonymous",width:60,render:e=>e?(0,p.jsx)("span",{style:{color:"#ff4d4f",fontWeight:"bold"},children:"\u662f"}):(0,p.jsx)("span",{style:{color:"#52c41a"},children:"\u5426"})},{key:"created_at",title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"created_at",width:150,render:e=>(0,p.jsx)("span",{style:{fontSize:"12px",color:"#666"},children:new Date(e).toLocaleString("zh-CN")})}],k=[{key:"id",title:"ID",dataIndex:"id",width:60},{key:"name",title:"\u540d\u79f0",dataIndex:"name",width:160},{key:"description",title:"\u63cf\u8ff0",dataIndex:"description",width:200,render:e=>(0,p.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block",maxWidth:"200px"},children:e||"-"})},{key:"leaderboard_id",title:"\u699c\u5355ID",dataIndex:"leaderboard_id",width:80},{key:"vote_count",title:"\u7968\u6570",dataIndex:"vote_count",width:80},{key:"status",title:"\u72b6\u6001",dataIndex:"status",width:80,render:e=>(0,p.jsx)("span",{style:{padding:"4px 8px",borderRadius:"4px",background:"active"===e?"#d4edda":"#f8d7da",color:"active"===e?"#155724":"#721c24",fontSize:"12px"},children:e})},{key:"actions",title:"\u64cd\u4f5c",width:120,align:"center",render:(e,t)=>(0,p.jsxs)("div",{style:{display:"flex",gap:"8px",justifyContent:"center"},children:[(0,p.jsx)("button",{onClick:()=>b.open({id:t.id,name:t.name,description:t.description||"",image_url:t.image_url||"",leaderboard_id:t.leaderboard_id}),style:{padding:"4px 8px",border:"1px solid #007bff",background:"white",color:"#007bff",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"\u7f16\u8f91"}),(0,p.jsx)("button",{onClick:()=>w(t.id),style:{padding:"4px 8px",border:"1px solid #dc3545",background:"white",color:"#dc3545",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"\u5220\u9664"})]})}],C=[{key:"id",title:"ID",dataIndex:"id",width:60},{key:"name",title:"\u540d\u79f0",dataIndex:"name",width:160},{key:"description",title:"\u63cf\u8ff0",width:250,render:(e,t)=>(0,p.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block",maxWidth:"250px"},children:t.description||"-"})},{key:"created_at",title:"\u63d0\u4ea4\u65f6\u95f4",dataIndex:"created_at",width:150,render:e=>(0,p.jsx)("span",{style:{fontSize:"12px",color:"#666"},children:new Date(e).toLocaleString("zh-CN")})},{key:"actions",title:"\u64cd\u4f5c",width:140,align:"center",render:(e,t)=>(0,p.jsxs)("div",{style:{display:"flex",gap:"8px",justifyContent:"center"},children:[(0,p.jsx)("button",{onClick:()=>v(t.id,"approve"),style:{padding:"4px 8px",border:"none",background:"#28a745",color:"white",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"\u6279\u51c6"}),(0,p.jsx)("button",{onClick:()=>v(t.id,"reject"),style:{padding:"4px 8px",border:"none",background:"#dc3545",color:"white",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"\u62d2\u7edd"})]})}],_=(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[(0,p.jsx)("button",{onClick:b.close,style:{padding:"8px 16px",border:"1px solid #d9d9d9",borderRadius:"4px",background:"white",cursor:"pointer"},children:"\u53d6\u6d88"}),(0,p.jsx)("button",{onClick:b.handleSubmit,disabled:b.loading,style:{padding:"8px 16px",border:"none",borderRadius:"4px",background:"#007bff",color:"white",cursor:b.loading?"not-allowed":"pointer",opacity:b.loading?.7:1},children:b.loading?"\u63d0\u4ea4\u4e2d...":b.isEdit?"\u66f4\u65b0":"\u521b\u5efa"})]});return(0,p.jsxs)("div",{children:[(0,p.jsx)("h2",{style:{marginBottom:"20px"},children:"\u6392\u884c\u699c\u7ba1\u7406"}),(0,p.jsx)("div",{style:{display:"flex",gap:"10px",marginBottom:"20px"},children:["items","votes","reviews"].map(d=>(0,p.jsx)("button",{onClick:()=>t(d),style:{padding:"10px 20px",border:"none",background:e===d?"#007bff":"#f0f0f0",color:e===d?"white":"black",cursor:"pointer",borderRadius:"5px",fontSize:"14px",fontWeight:"500"},children:"items"===d?"\u7ade\u54c1\u7ba1\u7406":"votes"===d?"\u6295\u7968\u8bb0\u5f55":"\u5ba1\u6838\u961f\u5217"},d))}),"items"===e&&(0,p.jsxs)("div",{children:[(0,p.jsx)("div",{style:{marginBottom:"20px"},children:(0,p.jsx)("button",{onClick:()=>b.open(),style:{padding:"10px 20px",border:"none",background:"#28a745",color:"white",borderRadius:"4px",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"\u521b\u5efa\u7ade\u54c1"})}),(0,p.jsx)(n.G8,{columns:k,data:y.data,loading:y.loading,rowKey:"id",emptyText:"\u6682\u65e0\u7ade\u54c1"}),(0,p.jsx)(n.E1,{currentPage:y.currentPage,totalPages:y.totalPages,total:y.total,pageSize:y.pageSize,onPageChange:y.setCurrentPage,onPageSizeChange:y.setPageSize})]}),"votes"===e&&(0,p.jsxs)("div",{children:[(0,p.jsxs)("div",{style:{background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",marginBottom:"20px",display:"flex",flexWrap:"wrap",gap:"10px",alignItems:"center"},children:[(0,p.jsx)("input",{type:"number",placeholder:"\u7ade\u54c1ID",value:d.item_id||"",onChange:e=>x((0,i.A)((0,i.A)({},d),{},{item_id:e.target.value?parseInt(e.target.value):void 0})),style:{padding:"8px",borderRadius:"4px",border:"1px solid #ddd",width:"120px"}}),(0,p.jsx)("input",{type:"number",placeholder:"\u699c\u5355ID",value:d.leaderboard_id||"",onChange:e=>x((0,i.A)((0,i.A)({},d),{},{leaderboard_id:e.target.value?parseInt(e.target.value):void 0})),style:{padding:"8px",borderRadius:"4px",border:"1px solid #ddd",width:"120px"}}),(0,p.jsxs)("select",{value:void 0===d.is_anonymous?"":d.is_anonymous?"true":"false",onChange:e=>x((0,i.A)((0,i.A)({},d),{},{is_anonymous:""===e.target.value?void 0:"true"===e.target.value})),style:{padding:"8px",borderRadius:"4px",border:"1px solid #ddd"},children:[(0,p.jsx)("option",{value:"",children:"\u5168\u90e8"}),(0,p.jsx)("option",{value:"true",children:"\u533f\u540d"}),(0,p.jsx)("option",{value:"false",children:"\u975e\u533f\u540d"})]}),(0,p.jsx)("input",{type:"text",placeholder:"\u641c\u7d22\u7528\u6237\u540d/\u7559\u8a00\u5185\u5bb9",value:d.keyword||"",onChange:e=>x((0,i.A)((0,i.A)({},d),{},{keyword:e.target.value||void 0})),style:{padding:"8px",borderRadius:"4px",border:"1px solid #ddd",flex:1,minWidth:"200px"}}),(0,p.jsx)("button",{onClick:()=>g.refresh(),style:{padding:"8px 16px",border:"none",background:"#007bff",color:"white",borderRadius:"4px",cursor:"pointer"},children:"\u641c\u7d22"}),(0,p.jsx)("button",{onClick:()=>{x({}),g.refresh()},style:{padding:"8px 16px",border:"none",background:"#6c757d",color:"white",borderRadius:"4px",cursor:"pointer"},children:"\u91cd\u7f6e"})]}),(0,p.jsx)(n.G8,{columns:j,data:g.data,loading:g.loading,rowKey:"id",emptyText:"\u6682\u65e0\u6295\u7968\u8bb0\u5f55"}),(0,p.jsx)(n.E1,{currentPage:g.currentPage,totalPages:g.totalPages,total:g.total,pageSize:g.pageSize,onPageChange:g.setCurrentPage,onPageSizeChange:g.setPageSize})]}),"reviews"===e&&(0,p.jsxs)("div",{children:[(0,p.jsx)(n.G8,{columns:C,data:f.data,loading:f.loading,rowKey:"id",emptyText:"\u6682\u65e0\u5f85\u5ba1\u6838\u7ade\u54c1"}),(0,p.jsx)(n.E1,{currentPage:f.currentPage,totalPages:f.totalPages,total:f.total,pageSize:f.pageSize,onPageChange:f.setCurrentPage,onPageSizeChange:f.setPageSize})]}),(0,p.jsx)(n.lM,{isOpen:b.isOpen,onClose:b.close,title:b.isEdit?"\u7f16\u8f91\u7ade\u54c1":"\u521b\u5efa\u7ade\u54c1",footer:_,width:"500px",children:(0,p.jsxs)("div",{style:{padding:"20px 0"},children:[(0,p.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,p.jsxs)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:["\u540d\u79f0 ",(0,p.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,p.jsx)("input",{type:"text",value:b.formData.name,onChange:e=>b.updateField("name",e.target.value),placeholder:"\u8bf7\u8f93\u5165\u7ade\u54c1\u540d\u79f0",style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]}),(0,p.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,p.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"\u63cf\u8ff0"}),(0,p.jsx)("textarea",{value:b.formData.description,onChange:e=>b.updateField("description",e.target.value),placeholder:"\u8bf7\u8f93\u5165\u7ade\u54c1\u63cf\u8ff0",rows:3,style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",resize:"vertical"}})]}),(0,p.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,p.jsx)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"\u56fe\u7247URL"}),(0,p.jsx)("input",{type:"text",value:b.formData.image_url,onChange:e=>b.updateField("image_url",e.target.value),placeholder:"\u8bf7\u8f93\u5165\u56fe\u7247URL",style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]}),(0,p.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,p.jsxs)("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:["\u699c\u5355ID ",(0,p.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,p.jsx)("input",{type:"number",value:b.formData.leaderboard_id,onChange:e=>b.updateField("leaderboard_id",e.target.value?parseInt(e.target.value):""),placeholder:"\u8bf7\u8f93\u5165\u699c\u5355ID",style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}})]})]})})]})}}}]);
//# sourceMappingURL=204.b70a3e6a.chunk.js.map