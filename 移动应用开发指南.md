# LinkU 移动应用开发指南

## 概述

本指南描述如何开发LinkU的iOS和Android移动应用。应用将复用现有的后端API，无需修改后端代码。应用专注于用户端功能，包括任务发布、跳蚤市场、实时消息等核心功能。

---

## 第一部分：项目准备与环境搭建

### iOS开发环境准备

**第一步：安装开发工具**
- 在Mac上安装Xcode（从App Store下载最新版本）
- 安装Xcode命令行工具，用于在终端执行构建命令
- 确保系统版本为macOS 13.0或更高

**第二步：创建iOS项目**
- 打开Xcode，选择创建新项目
- 选择iOS平台，应用类型选择"App"
- 项目名称设置为"LinkU"
- 界面框架选择SwiftUI（推荐）或UIKit
- 编程语言选择Swift
- 创建项目后，Xcode会自动生成基础的项目结构

**第三步：配置项目权限**
- 在项目配置文件中添加位置权限说明，用于获取用户所在城市
- 添加相机权限说明，用于拍摄任务或商品图片
- 添加相册权限说明，用于从相册选择图片
- 添加通知权限说明，用于接收任务和消息通知
- 这些权限说明会在用户首次使用时显示，需要清晰说明用途

**第四步：配置网络访问**
- 在项目配置中允许HTTP和HTTPS网络访问
- 配置后端API的基础地址（从环境变量或配置文件读取）
- 设置WebSocket连接的地址

### Android开发环境准备

**第一步：安装开发工具**
- 下载并安装Android Studio（最新版本）
- 安装Android SDK，确保API级别至少为24（Android 7.0）
- 安装JDK 17或更高版本
- 配置Android SDK路径

**第二步：创建Android项目**
- 打开Android Studio，选择创建新项目
- 选择"Empty Activity"模板
- 项目名称设置为"LinkU"
- 编程语言选择Kotlin
- 最低SDK版本设置为24
- 界面框架选择Jetpack Compose（推荐）或传统View System
- 创建项目后，Android Studio会自动生成基础的项目结构

**第三步：配置项目权限**
- 在Android清单文件中添加网络访问权限
- 添加位置权限（精确位置和粗略位置）
- 添加相机权限
- 添加存储读取权限（用于选择图片）
- 添加通知权限（Android 13及以上需要）
- 这些权限会在应用安装时或首次使用时请求

**第四步：配置网络访问**
- 在Android清单文件中配置网络安全策略，允许HTTP和HTTPS访问
- 配置后端API的基础地址（从配置文件或环境变量读取）
- 设置WebSocket连接的地址

---

## 第二部分：项目架构搭建

### iOS架构搭建

**第一步：创建目录结构**
- 在项目中创建Models文件夹，用于存放数据模型（任务、用户、消息等）
- 创建Views文件夹，用于存放所有界面视图
- 创建ViewModels文件夹，用于存放视图模型（处理业务逻辑）
- 创建Services文件夹，用于存放服务类（API调用、WebSocket、图片处理等）
- 创建Utils文件夹，用于存放工具类（Token管理、错误处理等）

**第二步：设置MVVM架构**
- 每个主要功能模块都采用MVVM模式
- View层负责界面展示，使用SwiftUI构建
- ViewModel层负责业务逻辑，继承ObservableObject，使用@Published属性发布状态变化
- Model层定义数据结构，实现Codable协议以便JSON序列化
- Service层负责网络请求和数据持久化

**第三步：配置依赖管理**
- 使用Swift Package Manager管理依赖（如果需要第三方库）
- 或者使用CocoaPods（如果团队更熟悉）
- 主要依赖包括网络请求库、图片加载库等（如果需要）

### Android架构搭建

**第一步：创建目录结构**
- 在app/src/main/java/com/linku/app/下创建data文件夹，存放数据模型和API接口
- 创建ui文件夹，存放所有界面相关代码
- 创建viewmodel文件夹，存放视图模型
- 创建utils文件夹，存放工具类

**第二步：设置MVVM架构**
- 每个主要功能模块都采用MVVM模式
- UI层使用Jetpack Compose构建界面
- ViewModel层使用StateFlow管理状态，使用Kotlin Coroutines处理异步操作
- Repository层负责数据获取和缓存
- DataSource层负责API调用和本地数据库操作

**第三步：配置依赖管理**
- 在build.gradle.kts文件中添加必要的依赖
- 包括Jetpack Compose相关库、网络请求库（Retrofit、OkHttp）、协程库等
- 配置Room数据库（如果需要本地缓存）
- 配置DataStore（用于存储Token和用户偏好）

---

## 第三部分：用户认证模块开发

### iOS认证模块

**第一步：创建登录界面**
- 使用SwiftUI创建一个登录视图
- 界面包含邮箱输入框、密码输入框、登录按钮
- 添加"忘记密码"链接和"注册"链接
- 界面设计要简洁美观，符合iOS设计规范

**第二步：实现登录功能**
- 在AuthViewModel中实现登录逻辑
- 调用后端登录API，传递邮箱和密码
- 接收返回的Token和用户信息
- 将Token存储到Keychain中（使用KeychainHelper工具类）
- 将用户信息保存到内存或UserDefaults中
- 登录成功后，自动跳转到主界面

**第三步：实现注册功能**
- 创建注册视图，包含邮箱、密码、确认密码等输入框
- 实现邮箱验证码发送功能（调用后端API）
- 实现注册提交功能，验证邮箱验证码后完成注册
- 注册成功后自动登录

**第四步：实现Token管理**
- 创建KeychainHelper工具类，用于安全存储Token
- 实现Token读取、保存、删除功能
- 在应用启动时检查Token是否存在，如果存在则自动登录
- 在API请求中自动添加Token到请求头

**第五步：实现自动登录**
- 在应用启动时（LinkUApp.swift中），检查是否有保存的Token
- 如果有Token，调用验证Token的API确认Token是否有效
- 如果Token有效，直接进入主界面
- 如果Token无效或不存在，显示登录界面

### Android认证模块

**第一步：创建登录界面**
- 使用Jetpack Compose创建登录屏幕
- 界面包含邮箱输入框、密码输入框、登录按钮
- 添加"忘记密码"和"注册"链接
- 使用Material Design设计规范

**第二步：实现登录功能**
- 在AuthViewModel中实现登录逻辑
- 使用Retrofit调用后端登录API
- 接收Token和用户信息
- 将Token存储到DataStore中（使用TokenManager工具类）
- 将用户信息保存到内存或SharedPreferences中
- 登录成功后，导航到主界面

**第三步：实现注册功能**
- 创建注册屏幕，包含邮箱、密码等输入框
- 实现邮箱验证码发送功能
- 实现注册提交功能
- 注册成功后自动登录

**第四步：实现Token管理**
- 创建TokenManager工具类，使用DataStore存储Token
- 实现Token的读取、保存、删除功能
- 在Retrofit拦截器中自动添加Token到请求头

**第五步：实现自动登录**
- 在应用启动时（MainActivity或Application类中），检查Token
- 如果有Token，验证Token有效性
- Token有效则进入主界面，无效则显示登录界面

---

## 第四部分：主界面和导航开发

### iOS主界面

**第一步：创建底部导航栏**
- 使用SwiftUI的TabView创建底部导航栏
- 包含五个标签：首页、任务、跳蚤市场、消息、我的
- 每个标签使用系统图标和文字标签
- 设置选中和未选中状态的颜色

**第二步：创建首页**
- 创建HomeView，显示欢迎信息和快速操作按钮
- 添加"发布任务"和"发布商品"的快捷入口
- 显示推荐任务列表（调用后端API获取）
- 显示最新任务列表
- 实现下拉刷新功能

**第三步：实现导航逻辑**
- 在ContentView中根据登录状态切换界面
- 未登录显示登录界面，已登录显示主界面
- 实现页面间的导航跳转（使用NavigationView和NavigationLink）

### Android主界面

**第一步：创建底部导航栏**
- 使用Jetpack Compose的BottomNavigation组件
- 包含五个标签：首页、任务、跳蚤市场、消息、我的
- 使用Material Design图标
- 设置选中和未选中状态

**第二步：创建首页**
- 创建HomeScreen，显示欢迎信息和快捷操作
- 添加发布任务的快捷按钮
- 显示推荐任务列表
- 实现下拉刷新（使用SwipeRefresh）

**第三步：实现导航逻辑**
- 使用Jetpack Navigation组件管理页面导航
- 在AppNavigation中定义所有路由
- 根据登录状态决定起始页面
- 实现页面间的导航跳转

---

## 第五部分：任务模块开发

### iOS任务模块

**第一步：创建任务列表界面**
- 创建TasksView，显示任务列表
- 使用LazyVStack实现列表，支持滚动和懒加载
- 每个任务显示为卡片样式，包含标题、描述、价格、城市、发布时间
- 显示任务状态标签（开放、进行中、已完成等）
- 实现下拉刷新和上拉加载更多

**第二步：实现任务筛选功能**
- 在界面顶部添加筛选栏
- 支持按分类筛选（跑腿、代购、翻译等）
- 支持按城市筛选
- 支持按价格范围筛选
- 筛选条件改变时，重新请求任务列表

**第三步：实现任务搜索功能**
- 在界面顶部添加搜索框
- 用户输入关键词后，调用后端搜索API
- 显示搜索结果列表
- 支持清空搜索，恢复显示全部任务

**第四步：创建任务详情界面**
- 创建TaskDetailView，显示任务的完整信息
- 显示任务标题、详细描述、图片、价格、截止时间等
- 显示发布者信息（头像、昵称、评分等）
- 添加"申请任务"按钮（如果用户未申请）
- 显示申请者列表（仅任务发布者可见）
- 实现任务状态更新功能（发布者可以接受申请、标记完成等）

**第五步：创建发布任务界面**
- 创建PublishTaskView，包含任务发布表单
- 表单包含：任务标题、任务描述、任务分类、价格、截止时间、城市
- 添加图片上传功能，支持选择多张图片
- 使用ImagePickerService选择图片，调用后端API上传
- 图片上传后显示预览，支持删除已选图片
- 表单验证：确保必填项都已填写
- 提交表单后，调用后端API创建任务
- 创建成功后，返回任务列表并刷新

**第六步：实现我的任务管理**
- 在个人中心添加"我的任务"入口
- 创建MyTasksView，显示用户相关的任务
- 分为三个标签页：我发布的、我申请的、我完成的
- 每个标签页显示对应状态的任务列表
- 支持查看任务详情、更新任务状态、取消任务等操作

### Android任务模块

**第一步：创建任务列表界面**
- 创建TasksScreen，使用LazyColumn显示任务列表
- 每个任务使用Card组件显示
- 显示任务的关键信息
- 实现下拉刷新和分页加载

**第二步：实现任务筛选和搜索**
- 添加筛选栏，支持分类和城市筛选
- 添加搜索框，实现关键词搜索
- 筛选和搜索条件改变时，重新加载列表

**第三步：创建任务详情界面**
- 创建TaskDetailScreen，显示任务完整信息
- 使用Column布局，显示各项信息
- 添加申请任务按钮
- 实现任务状态管理功能

**第四步：创建发布任务界面**
- 创建PublishTaskScreen，包含任务发布表单
- 使用TextField组件输入任务信息
- 实现图片选择功能，使用Activity Result API
- 调用后端API上传图片
- 实现表单验证和提交功能

**第五步：实现我的任务管理**
- 在个人中心添加我的任务入口
- 创建MyTasksScreen，使用TabRow显示三个标签
- 每个标签显示对应状态的任务列表

---

## 第六部分：跳蚤市场模块开发

### iOS跳蚤市场模块

**第一步：创建商品列表界面**
- 创建FleaMarketView，使用网格布局显示商品
- 使用LazyVGrid实现两列或三列网格
- 每个商品显示为卡片，包含商品图片、标题、价格、城市
- 点击商品卡片，跳转到商品详情
- 实现下拉刷新和上拉加载更多

**第二步：实现商品筛选功能**
- 添加分类筛选栏（电子产品、家具、服装等）
- 添加价格范围筛选
- 添加城市筛选
- 筛选条件改变时，重新加载商品列表

**第三步：创建商品详情界面**
- 创建FleaMarketItemDetailView（或使用模态视图）
- 显示商品的所有图片（支持滑动浏览）
- 显示商品标题、描述、价格、城市、发布时间
- 显示卖家信息
- 添加"联系卖家"按钮，跳转到消息界面
- 添加收藏功能（如果后端支持）

**第四步：创建发布商品界面**
- 创建PublishFleaMarketView，包含商品发布表单
- 表单包含：商品标题、商品描述、商品分类、价格、城市
- 添加图片上传功能，支持选择多张图片
- 图片上传后显示预览，支持删除和重新排序
- 表单验证后，调用后端API创建商品
- 创建成功后，返回商品列表

**第五步：实现我的发布管理**
- 在个人中心添加"我的发布"入口
- 创建MyFleaMarketView，显示用户发布的商品
- 支持编辑商品信息、下架商品、删除商品等操作

### Android跳蚤市场模块

**第一步：创建商品列表界面**
- 创建FleaMarketScreen，使用LazyVerticalGrid显示商品网格
- 每个商品使用Card组件
- 实现下拉刷新和分页加载

**第二步：实现商品筛选**
- 添加分类筛选
- 添加价格和城市筛选
- 筛选条件改变时重新加载

**第三步：创建商品详情界面**
- 创建FleaMarketItemDetailScreen
- 使用Column和Row布局显示商品信息
- 添加联系卖家按钮

**第四步：创建发布商品界面**
- 创建PublishFleaMarketScreen
- 实现商品信息输入和图片上传
- 调用后端API创建商品

**第五步：实现我的发布管理**
- 创建MyFleaMarketScreen
- 显示用户发布的商品列表
- 支持编辑和下架操作

---

## 第七部分：实时消息模块开发

### iOS消息模块

**第一步：创建消息列表界面**
- 创建MessageView，显示对话列表
- 每个对话显示对方头像、昵称、最后一条消息、未读消息数、时间
- 未读消息用红色数字徽章显示
- 点击对话，跳转到聊天界面
- 实现下拉刷新，获取最新对话列表

**第二步：创建聊天界面**
- 创建ChatView（或作为MessageView的子视图）
- 界面分为消息列表区域和输入区域
- 消息列表显示所有消息，自己的消息靠右，对方的消息靠左
- 显示消息时间（每条消息或消息组显示一次时间）
- 显示消息状态（发送中、已发送、已读）
- 输入区域包含文本输入框和发送按钮
- 支持发送图片（选择图片后上传，然后发送图片URL）

**第三步：实现WebSocket连接**
- 创建WebSocketService，管理WebSocket连接
- 在用户登录后，自动建立WebSocket连接
- 连接URL包含用户Token用于认证
- 实现连接成功、断开、重连的逻辑
- 实现心跳机制，保持连接活跃

**第四步：实现消息发送和接收**
- 在WebSocketService中实现发送消息的方法
- 消息格式为JSON，包含接收者ID、消息内容、消息类型等
- 接收WebSocket消息，解析JSON，更新消息列表
- 新消息到达时，更新对话列表的未读消息数
- 如果当前正在查看该对话，标记消息为已读

**第五步：实现消息状态更新**
- 发送消息后，先显示为"发送中"状态
- 收到服务器确认后，更新为"已发送"
- 收到对方已读回执后，更新为"已读"
- 如果发送失败，显示重试按钮

**第六步：实现推送通知**
- 在NotificationManager中请求通知权限
- 当收到新消息且应用在后台时，显示本地通知
- 通知包含发送者名称和消息预览
- 点击通知，打开应用并跳转到对应对话

### Android消息模块

**第一步：创建消息列表界面**
- 创建MessageScreen，使用LazyColumn显示对话列表
- 每个对话使用Card或ListItem组件
- 显示未读消息数徽章
- 点击跳转到聊天界面

**第二步：创建聊天界面**
- 创建ChatScreen，显示消息列表和输入框
- 使用LazyColumn显示消息
- 自己的消息和对方的消息使用不同的样式
- 实现消息输入和发送功能

**第三步：实现WebSocket连接**
- 创建WebSocketService，使用OkHttp的WebSocket功能
- 在用户登录后建立连接
- 实现自动重连机制
- 实现心跳保活

**第四步：实现消息发送和接收**
- 在WebSocketService中实现消息发送
- 接收WebSocket消息，解析并更新UI
- 更新未读消息计数

**第五步：实现推送通知**
- 创建通知渠道（NotificationChannel）
- 收到新消息时显示通知
- 点击通知打开对应对话

---

## 第八部分：个人中心模块开发

### iOS个人中心

**第一步：创建个人中心界面**
- 创建ProfileView，显示用户信息
- 顶部显示用户头像、昵称、邮箱
- 显示用户等级、积分、VIP状态（如果有）
- 添加编辑资料按钮，跳转到资料编辑界面

**第二步：添加功能入口**
- 添加"我的任务"入口，跳转到我的任务列表
- 添加"我的发布"入口，跳转到我的发布列表
- 添加"钱包"入口（如果后端已实现）
- 添加"设置"入口，跳转到设置界面

**第三步：创建设置界面**
- 创建SettingsView，包含各种设置选项
- 语言切换（中文/英文）
- 通知设置（开启/关闭各类通知）
- 关于我们
- 退出登录按钮

**第四步：实现退出登录**
- 点击退出登录，清除本地Token和用户信息
- 断开WebSocket连接
- 返回登录界面

### Android个人中心

**第一步：创建个人中心界面**
- 创建ProfileScreen，显示用户信息
- 使用Card组件显示用户资料
- 添加编辑资料入口

**第二步：添加功能入口**
- 添加我的任务、我的发布、钱包等入口
- 使用Card或ListItem组件

**第三步：创建设置界面**
- 创建SettingsScreen
- 实现语言切换、通知设置等
- 实现退出登录功能

---

## 第九部分：原生功能集成

### iOS原生功能

**第一步：集成相机功能**
- 使用UIImagePickerController或PHPickerViewController
- 在需要上传图片的地方，弹出图片选择器
- 支持从相机拍摄或从相册选择
- 选择图片后，压缩图片（如果图片过大）
- 调用后端API上传图片
- 上传成功后，将图片URL用于任务或商品发布

**第二步：集成定位功能**
- 使用CoreLocation框架获取用户位置
- 请求位置权限（使用中权限即可）
- 获取位置后，转换为城市名称
- 在城市选择时，可以自动填充当前城市
- 也可以手动选择城市

**第三步：集成推送通知**
- 在应用启动时请求通知权限
- 配置APNs（Apple Push Notification service）
- 获取设备Token并发送到后端
- 收到推送通知时，根据通知类型跳转到对应页面
- 实现本地通知（用于应用内通知）

**第四步：实现后台任务**
- 配置后台模式，允许应用在后台接收消息
- 使用后台任务保持WebSocket连接（如果可能）
- 或者使用推送通知作为消息接收的补充

### Android原生功能

**第一步：集成相机功能**
- 使用Activity Result API选择图片
- 支持从相机拍摄或从相册选择
- 使用图片压缩库压缩图片
- 调用后端API上传图片

**第二步：集成定位功能**
- 使用FusedLocationProviderClient获取位置
- 请求位置权限
- 获取位置后转换为城市名称
- 在城市选择时自动填充或手动选择

**第三步：集成推送通知**
- 集成Firebase Cloud Messaging（FCM）或使用其他推送服务
- 获取设备Token并发送到后端
- 创建通知渠道
- 收到推送通知时，根据类型跳转
- 实现本地通知

**第四步：实现后台服务**
- 使用WorkManager处理后台任务
- 保持WebSocket连接（在可能的情况下）
- 或使用推送通知作为补充

---

## 第十部分：API集成

### 通用API集成说明

**第一步：配置API基础地址**
- 在Constants或Config文件中定义API基础URL
- 从环境变量或配置文件读取（开发环境和生产环境使用不同地址）
- WebSocket地址也在此配置

**第二步：创建API服务类**
- iOS：创建APIService类，使用URLSession进行网络请求
- Android：创建ApiService接口，使用Retrofit定义API端点
- 所有API调用都通过这个服务类进行

**第三步：实现Token自动注入**
- iOS：在URLRequest中添加Authorization头，从Keychain读取Token
- Android：在OkHttp拦截器中添加Authorization头，从DataStore读取Token
- 如果Token过期，自动刷新Token（如果后端支持）

**第四步：实现错误处理**
- 统一处理网络错误（无网络、超时等）
- 统一处理API错误（401未授权、404未找到、500服务器错误等）
- 401错误时，清除Token并返回登录界面
- 其他错误显示友好的错误提示

**第五步：实现请求缓存**
- 对于不经常变化的数据（如城市列表、分类列表），实现本地缓存
- iOS：使用UserDefaults或Core Data
- Android：使用Room数据库或DataStore
- 首次加载从网络获取，后续从缓存读取

### 主要API端点对接

**用户认证API**
- 登录：POST /api/auth/login
- 注册：POST /api/auth/register
- 验证邮箱：POST /api/auth/verify-email
- 刷新Token：POST /api/auth/refresh（如果支持）

**任务相关API**
- 获取任务列表：GET /api/tasks（支持分页、筛选、搜索参数）
- 获取任务详情：GET /api/tasks/{id}
- 创建任务：POST /api/tasks
- 更新任务：PUT /api/tasks/{id}
- 申请任务：POST /api/tasks/{id}/apply
- 获取我的任务：GET /api/tasks/my

**跳蚤市场API**
- 获取商品列表：GET /api/flea-market（支持分页、筛选、搜索）
- 获取商品详情：GET /api/flea-market/{id}
- 创建商品：POST /api/flea-market
- 更新商品：PUT /api/flea-market/{id}
- 获取我的发布：GET /api/flea-market/my

**消息相关API**
- 获取对话列表：GET /api/messages/conversations
- 获取对话消息：GET /api/messages/conversations/{id}/messages
- 发送消息：POST /api/messages/send（也可以通过WebSocket发送）
- 标记消息已读：PUT /api/messages/{id}/read

**用户相关API**
- 获取用户信息：GET /api/users/me
- 更新用户信息：PUT /api/users/me
- 上传头像：POST /api/upload/avatar

**文件上传API**
- 上传图片：POST /api/upload/image
- 返回图片URL，用于任务或商品发布

**WebSocket连接**
- 连接地址：wss://your-backend-url/ws?token={token}
- 消息格式：JSON
- 支持的消息类型：新消息、消息已读、任务更新通知等

---

## 第十一部分：测试与优化

### 功能测试

**第一步：单元测试**
- iOS：使用XCTest框架编写单元测试
- Android：使用JUnit编写单元测试
- 测试ViewModel/Repository的逻辑
- 测试工具类的功能

**第二步：UI测试**
- iOS：使用XCUITest编写UI测试
- Android：使用Espresso或Compose Testing编写UI测试
- 测试主要用户流程（登录、发布任务、发送消息等）

**第三步：集成测试**
- 测试与后端API的集成
- 测试WebSocket连接和消息收发
- 测试文件上传功能

**第四步：真机测试**
- 在真实设备上测试所有功能
- 测试不同网络环境（WiFi、4G、5G）
- 测试不同设备尺寸和系统版本

### 性能优化

**第一步：图片优化**
- 上传前压缩图片，减少上传时间和流量
- 使用图片缓存，避免重复下载
- 使用懒加载，只加载可见区域的图片

**第二步：网络优化**
- 实现请求去重，避免重复请求
- 实现请求缓存，减少不必要的网络请求
- 使用分页加载，避免一次性加载大量数据

**第三步：界面优化**
- 使用虚拟列表（LazyVStack/LazyColumn），只渲染可见项
- 优化动画性能，避免卡顿
- 减少不必要的界面重绘

**第四步：启动优化**
- 减少应用启动时间
- 延迟加载非关键功能
- 优化首屏加载速度

---

## 第十二部分：发布准备

### iOS发布准备

**第一步：配置应用信息**
- 在Xcode中配置应用名称、图标、启动画面
- 配置Bundle Identifier
- 设置应用版本号和构建号

**第二步：配置证书和描述文件**
- 在Apple Developer网站创建App ID
- 创建开发证书和发布证书
- 创建描述文件（Provisioning Profile）
- 在Xcode中配置自动签名或手动签名

**第三步：准备应用截图和描述**
- 准备不同尺寸的应用截图（iPhone各种尺寸）
- 编写应用描述、关键词、更新说明
- 准备隐私政策链接

**第四步：构建和上传**
- 在Xcode中选择Product > Archive
- 验证Archive
- 上传到App Store Connect
- 在App Store Connect中提交审核

### Android发布准备

**第一步：配置应用信息**
- 在build.gradle.kts中配置应用名称、包名、版本号
- 准备应用图标和启动画面
- 配置应用权限说明

**第二步：生成签名密钥**
- 使用keytool生成签名密钥
- 在build.gradle.kts中配置签名信息
- 妥善保管密钥文件

**第三步：构建发布版本**
- 构建AAB（Android App Bundle）文件
- 或构建APK文件（如果使用APK分发）
- 测试发布版本

**第四步：准备商店信息**
- 准备应用截图（手机、平板各种尺寸）
- 编写应用描述、更新说明
- 准备隐私政策链接

**第五步：上传和发布**
- 在Google Play Console创建应用
- 上传AAB文件
- 填写商店信息
- 提交审核

---

## 开发注意事项

### 后端API兼容性

- 所有API调用都使用现有的后端接口，无需修改后端
- 确保API请求格式与Web端一致
- 确保Token认证方式一致
- 确保WebSocket消息格式一致

### 数据同步

- 移动端与Web端共享同一后端，数据自动同步
- 用户可以在移动端和Web端无缝切换
- WebSocket确保消息实时同步

### 用户体验

- 保持与Web端功能一致（用户端功能）
- 充分利用移动端原生特性（相机、定位、推送等）
- 优化移动端交互体验
- 考虑不同屏幕尺寸和系统版本

### 错误处理

- 网络错误时显示友好提示
- API错误时显示具体错误信息
- 实现重试机制（对于可重试的操作）
- 记录错误日志，便于问题排查

### 安全性

- Token安全存储（iOS使用Keychain，Android使用DataStore）
- 敏感信息加密存储
- 网络请求使用HTTPS
- 实现证书锁定（Certificate Pinning，可选）

---

## 总结

本指南描述了LinkU移动应用的完整开发流程，从环境搭建到功能实现，再到测试和发布。开发过程中，主要工作是：

1. **复用后端API**：所有功能都调用现有的后端接口，无需修改后端代码
2. **实现用户端功能**：专注于普通用户需要的功能，不包含客服和管理员功能
3. **原生体验**：充分利用iOS和Android的原生特性，提供最佳用户体验
4. **实时同步**：通过WebSocket实现消息实时同步，确保移动端和Web端数据一致

按照本指南的步骤，可以逐步完成iOS和Android应用的开发。建议先完成核心功能（认证、任务、消息），再逐步完善其他功能。

