# ä¼ä¸šçº§å·¥å…·è¿ç§»æŒ‡å—

æœ¬æŒ‡å—å¸®åŠ©æ‚¨å°†ç°æœ‰ä»£ç è¿ç§»åˆ°æ–°çš„ä¼ä¸šçº§å·¥å…·ã€‚

## ğŸ“‹ è¿ç§»æ¸…å•

### 1. ç½‘ç»œè¯·æ±‚è¿ç§»

#### æ—§ä»£ç 
```swift
func loadUser() {
    guard let url = URL(string: "\(baseURL)/api/users/me") else { return }
    var request = URLRequest(url: url)
    request.httpMethod = "GET"
    request.setValue(sessionId, forHTTPHeaderField: "X-Session-ID")
    
    URLSession.shared.dataTask(with: request) { data, response, error in
        // å¤„ç†å“åº”
    }.resume()
}
```

#### æ–°ä»£ç 
```swift
func loadUser() {
    do {
        let request = try RequestBuilder(
            baseURL: Constants.API.baseURL,
            endpoint: "/api/users/me"
        )
        .method("GET")
        .header("X-Session-ID", value: sessionId)
        .build()
        
        NetworkManager.shared.execute(User.self, request: request)
            .handleError { error in
                ErrorHandler.shared.handle(error, context: "åŠ è½½ç”¨æˆ·")
            }
            .receiveOnMain()
            .sink(
                receiveCompletion: { _ in },
                receiveValue: { user in
                    self.user = user
                }
            )
    } catch {
        ErrorHandler.shared.handle(error, context: "æ„å»ºè¯·æ±‚")
    }
}
```

### 2. é”™è¯¯å¤„ç†è¿ç§»

#### æ—§ä»£ç 
```swift
func loadData() {
    // ... ç½‘ç»œè¯·æ±‚
    if let error = error {
        print("é”™è¯¯: \(error.localizedDescription)")
        // æ˜¾ç¤ºé”™è¯¯æç¤º
    }
}
```

#### æ–°ä»£ç 
```swift
func loadData() {
    // ... ç½‘ç»œè¯·æ±‚
    .handleError { error in
        ErrorHandler.shared.handle(error, context: "åŠ è½½æ•°æ®")
    }
}
```

### 3. ç¼“å­˜è¿ç§»

#### æ—§ä»£ç 
```swift
var cachedUser: User?

func loadUser() {
    if let cached = cachedUser {
        self.user = cached
        return
    }
    // ... åŠ è½½ç”¨æˆ·
}
```

#### æ–°ä»£ç 
```swift
func loadUser() {
    // å…ˆå°è¯•ä»ç¼“å­˜è·å–
    if let cached = CacheManager.shared.get(
        forKey: "user_\(userId)",
        as: User.self
    ) {
        self.user = cached
        return
    }
    
    // åŠ è½½å¹¶ç¼“å­˜
    loadUserFromAPI()
        .sink { user in
            try? CacheManager.shared.set(
                user,
                forKey: "user_\(userId)",
                expiration: 3600
            )
            self.user = user
        }
}
```

### 4. çŠ¶æ€ç®¡ç†è¿ç§»

#### æ—§ä»£ç 
```swift
@Published var isLoading = false
@Published var errorMessage: String?

func loadData() {
    isLoading = true
    errorMessage = nil
    // ... åŠ è½½æ•°æ®
}
```

#### æ–°ä»£ç 
```swift
@Published var loadingState: LoadingState<Data> = .idle

func loadData() {
    loadingState = .loading
    // ... åŠ è½½æ•°æ®
    .sink(
        receiveCompletion: { completion in
            if case .failure(let error) = completion {
                self.loadingState = .error(error)
            }
        },
        receiveValue: { data in
            self.loadingState = .loaded(data)
        }
    )
}
```

### 5. æ—¥å¿—è¿ç§»

#### æ—§ä»£ç 
```swift
print("åŠ è½½ç”¨æˆ·æˆåŠŸ")
print("é”™è¯¯: \(error.localizedDescription)")
```

#### æ–°ä»£ç 
```swift
Logger.success("åŠ è½½ç”¨æˆ·æˆåŠŸ", category: .api)
Logger.error("åŠ è½½å¤±è´¥: \(error)", category: .api)
```

### 6. éªŒè¯è¿ç§»

#### æ—§ä»£ç 
```swift
func validateEmail(_ email: String) -> Bool {
    let emailRegex = "[A-Z0-9a-z._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,64}"
    let emailPredicate = NSPredicate(format:"SELF MATCHES %@", emailRegex)
    return emailPredicate.evaluate(with: email)
}
```

#### æ–°ä»£ç 
```swift
func validateEmail(_ email: String) -> Bool {
    return ValidationHelper.isValidEmail(email)
}
```

### 7. æ ¼å¼åŒ–è¿ç§»

#### æ—§ä»£ç 
```swift
let formatter = DateFormatter()
formatter.dateFormat = "yyyy-MM-dd HH:mm:ss"
let dateString = formatter.string(from: date)
```

#### æ–°ä»£ç 
```swift
let dateString = TimeFormatter.formatFullDateTime(date)
```

### 8. ä¾èµ–æ³¨å…¥è¿ç§»

#### æ—§ä»£ç 
```swift
class ViewModel {
    private let apiService = APIService()
    
    func loadData() {
        apiService.getData { result in
            // ...
        }
    }
}
```

#### æ–°ä»£ç 
```swift
class ViewModel {
    private let apiService: APIServiceProtocol
    
    init(apiService: APIServiceProtocol = DependencyContainer.shared.resolve(APIServiceProtocol.self)) {
        self.apiService = apiService
    }
    
    func loadData() {
        apiService.getData { result in
            // ...
        }
    }
}
```

## ğŸ¯ è¿ç§»ä¼˜å…ˆçº§

### é«˜ä¼˜å…ˆçº§
1. âœ… é”™è¯¯å¤„ç†ï¼ˆErrorHandlerï¼‰
2. âœ… ç½‘ç»œè¯·æ±‚ï¼ˆNetworkManager, RequestBuilderï¼‰
3. âœ… æ—¥å¿—ç³»ç»Ÿï¼ˆLoggerï¼‰

### ä¸­ä¼˜å…ˆçº§
4. âœ… ç¼“å­˜ç®¡ç†ï¼ˆCacheManagerï¼‰
5. âœ… çŠ¶æ€ç®¡ç†ï¼ˆLoadingStateï¼‰
6. âœ… æ•°æ®éªŒè¯ï¼ˆValidationHelperï¼‰

### ä½ä¼˜å…ˆçº§
7. âœ… æ ¼å¼åŒ–å·¥å…·ï¼ˆTimeFormatter, NumberFormatterï¼‰
8. âœ… æ‰©å±•æ–¹æ³•ï¼ˆString, Date, Array ç­‰ï¼‰
9. âœ… UI ç»„ä»¶ï¼ˆLoadingState, PaginatedListï¼‰

## ğŸ“ è¿ç§»æ­¥éª¤

1. **è¯„ä¼°ç°æœ‰ä»£ç **
   - è¯†åˆ«å¯ä»¥è¿ç§»çš„ä»£ç 
   - ç¡®å®šè¿ç§»ä¼˜å…ˆçº§

2. **é€æ­¥è¿ç§»**
   - ä»é«˜ä¼˜å…ˆçº§å¼€å§‹
   - ä¸€ä¸ªæ¨¡å—ä¸€ä¸ªæ¨¡å—è¿ç§»
   - ä¿æŒå‘åå…¼å®¹

3. **æµ‹è¯•éªŒè¯**
   - ç¡®ä¿åŠŸèƒ½æ­£å¸¸
   - æ£€æŸ¥æ€§èƒ½å½±å“
   - éªŒè¯é”™è¯¯å¤„ç†

4. **ä»£ç å®¡æŸ¥**
   - æ£€æŸ¥ä»£ç è´¨é‡
   - ç¡®ä¿ç¬¦åˆè§„èŒƒ
   - æ›´æ–°æ–‡æ¡£

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å‘åå…¼å®¹**
   - ä¿æŒç°æœ‰ API å¯ç”¨
   - é€æ­¥æ›¿æ¢æ—§ä»£ç 

2. **æ€§èƒ½å½±å“**
   - ç›‘æ§æ€§èƒ½å˜åŒ–
   - ä¼˜åŒ–ç“¶é¢ˆ

3. **æµ‹è¯•è¦†ç›–**
   - ç¡®ä¿æµ‹è¯•é€šè¿‡
   - æ·»åŠ æ–°æµ‹è¯•

4. **æ–‡æ¡£æ›´æ–°**
   - æ›´æ–°ä»£ç æ³¨é‡Š
   - æ›´æ–°ä½¿ç”¨æ–‡æ¡£

## ğŸ‰ è¿ç§»å®Œæˆ

è¿ç§»å®Œæˆåï¼Œæ‚¨å°†è·å¾—ï¼š
- âœ… æ›´å¥½çš„ä»£ç è´¨é‡
- âœ… æ›´é«˜çš„å¼€å‘æ•ˆç‡
- âœ… æ›´å¼ºçš„å¯ç»´æŠ¤æ€§
- âœ… æ›´å¥½çš„æ€§èƒ½
- âœ… æ›´å®Œå–„çš„é”™è¯¯å¤„ç†

