<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‡ªå®šä¹‰æ’è¡Œæ¦œ - LinkU</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/antd@5.12.8/dist/reset.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f5f5f5;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 24px;
            margin-bottom: 16px;
        }
        
        .filters {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        
        .filter-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .filter-item label {
            font-size: 14px;
            color: #666;
        }
        
        select, input {
            padding: 8px 12px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: #1890ff;
            color: white;
        }
        
        .btn-primary:hover {
            background: #40a9ff;
        }
        
        .btn-default {
            background: white;
            border: 1px solid #d9d9d9;
        }
        
        .btn-default:hover {
            border-color: #40a9ff;
            color: #40a9ff;
        }
        
        .btn-danger {
            background: #ff4d4f;
            color: white;
        }
        
        .btn-danger:hover {
            background: #ff7875;
        }
        
        .leaderboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .leaderboard-card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            border: 1px solid #e8e8e8;
        }
        
        .leaderboard-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .card-content {
            padding: 16px;
        }
        
        .card-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .card-tags {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }
        
        .tag {
            padding: 4px 8px;
            background: #f0f0f0;
            border-radius: 4px;
            font-size: 12px;
        }
        
        .tag-blue {
            background: #e6f7ff;
            color: #1890ff;
        }
        
        .card-stats {
            font-size: 12px;
            color: #999;
            margin-top: 8px;
        }
        
        /* æ¦œå•è¯¦æƒ…é¡µ */
        .detail-header {
            background: white;
            padding: 24px;
            border-radius: 8px;
            margin-bottom: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .detail-header h1 {
            font-size: 28px;
            margin-bottom: 16px;
        }
        
        .detail-description {
            color: #666;
            line-height: 1.6;
            margin-top: 16px;
        }
        
        .items-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        
        .item-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 12px;
        }
        
        .item-rank {
            font-size: 24px;
            font-weight: bold;
            color: #ffc107;
            margin-right: 12px;
        }
        
        .item-rank.top3 {
            color: #ffc107;
        }
        
        .item-rank.other {
            color: #666;
        }
        
        .item-info {
            flex: 1;
        }
        
        .item-name {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .item-description {
            color: #666;
            line-height: 1.6;
            margin-bottom: 8px;
        }
        
        .item-address {
            font-size: 12px;
            color: #999;
            margin-bottom: 8px;
        }
        
        .item-images {
            display: flex;
            gap: 8px;
            margin-top: 12px;
            flex-wrap: wrap;
        }
        
        .item-image {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 4px;
            cursor: pointer;
            border: 1px solid #e8e8e8;
        }
        
        .item-image:hover {
            border-color: #1890ff;
            transform: scale(1.05);
            transition: all 0.3s;
        }
        
        .item-image-placeholder {
            width: 100px;
            height: 100px;
            background: #f5f5f5;
            border: 1px dashed #d9d9d9;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-size: 12px;
        }
        
        .vote-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            min-width: 80px;
        }
        
        .vote-btn {
            padding: 8px 16px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            background: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s;
        }
        
        .vote-btn:hover {
            border-color: #1890ff;
            color: #1890ff;
        }
        
        .vote-btn.active {
            background: #1890ff;
            color: white;
            border-color: #1890ff;
        }
        
        .vote-btn.danger.active {
            background: #ff4d4f;
            border-color: #ff4d4f;
        }
        
        .vote-count {
            font-size: 16px;
            font-weight: 600;
        }
        
        .net-votes {
            font-size: 12px;
            color: #999;
        }
        
        .user-comment {
            margin-top: 12px;
            padding: 12px;
            background: #f5f5f5;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .user-comment-header {
            font-weight: 600;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .anonymous-tag {
            padding: 2px 6px;
            background: #f0f0f0;
            border-radius: 4px;
            font-size: 11px;
            color: #666;
        }
        
        /* æ¨¡æ€æ¡† */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.show {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: 8px;
            padding: 24px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 16px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            margin-top: 24px;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .checkbox-group input[type="checkbox"] {
            width: auto;
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }
        
        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #999;
        }
        
        .sort-selector {
            margin-bottom: 16px;
        }
        
        .sort-selector select {
            padding: 8px 12px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <!-- æ¦œå•åˆ—è¡¨é¡µ -->
    <div id="leaderboard-list-page" class="container">
        <div class="header">
            <h1>ğŸ† è‡ªå®šä¹‰æ’è¡Œæ¦œ</h1>
            <p style="color: #666; margin-bottom: 20px;">å‘ç°å’Œåˆ†äº«ä½ æ‰€åœ¨åœ°åŒºçš„æœ€ä½³é€‰æ‹©</p>
            
            <div class="filters">
                <div class="filter-item">
                    <label>åŸå¸‚ï¼š</label>
                    <select id="location-filter">
                        <option value="">å…¨éƒ¨åŸå¸‚</option>
                        <option value="Online">Online</option>
                        <option value="London">London</option>
                        <option value="Edinburgh">Edinburgh</option>
                        <option value="Manchester">Manchester</option>
                        <option value="Birmingham">Birmingham</option>
                        <option value="Glasgow">Glasgow</option>
                        <option value="Bristol">Bristol</option>
                        <option value="Sheffield">Sheffield</option>
                        <option value="Leeds">Leeds</option>
                        <option value="Nottingham">Nottingham</option>
                        <option value="Newcastle">Newcastle</option>
                        <option value="Southampton">Southampton</option>
                        <option value="Liverpool">Liverpool</option>
                        <option value="Cardiff">Cardiff</option>
                        <option value="Coventry">Coventry</option>
                        <option value="Exeter">Exeter</option>
                        <option value="Leicester">Leicester</option>
                        <option value="York">York</option>
                        <option value="Aberdeen">Aberdeen</option>
                        <option value="Bath">Bath</option>
                        <option value="Dundee">Dundee</option>
                        <option value="Reading">Reading</option>
                        <option value="St Andrews">St Andrews</option>
                        <option value="Belfast">Belfast</option>
                        <option value="Brighton">Brighton</option>
                        <option value="Durham">Durham</option>
                        <option value="Norwich">Norwich</option>
                        <option value="Swansea">Swansea</option>
                        <option value="Loughborough">Loughborough</option>
                        <option value="Lancaster">Lancaster</option>
                        <option value="Warwick">Warwick</option>
                        <option value="Cambridge">Cambridge</option>
                        <option value="Oxford">Oxford</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                
                <button class="btn btn-primary" onclick="showApplyModal()">
                    â• ç”³è¯·æ–°æ¦œå•
                </button>
            </div>
        </div>
        
        <div class="leaderboard-grid" id="leaderboard-grid">
            <!-- ç¤ºä¾‹å¡ç‰‡ -->
            <div class="leaderboard-card" onclick="openLeaderboardDetail(1)">
                <div class="card-content">
                    <div class="card-title">
                        ğŸ† Londonä¸­é¤æ¦œ
                    </div>
                    <div class="card-tags">
                        <span class="tag tag-blue">London</span>
                    </div>
                    <div class="card-stats">
                        25 ä¸ªç«å“ Â· 150 ç¥¨ Â· 500 æ¬¡æµè§ˆ
                    </div>
                </div>
            </div>
            
            <div class="leaderboard-card" onclick="openLeaderboardDetail(2)">
                <div class="card-content">
                    <div class="card-title">
                        ğŸ† Manchesterè¶…å¸‚æ¦œ
                    </div>
                    <div class="card-tags">
                        <span class="tag tag-blue">Manchester</span>
                    </div>
                    <div class="card-stats">
                        18 ä¸ªç«å“ Â· 89 ç¥¨ Â· 320 æ¬¡æµè§ˆ
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- æ¦œå•è¯¦æƒ…é¡µï¼ˆé»˜è®¤éšè—ï¼‰ -->
    <div id="leaderboard-detail-page" class="container" style="display: none;">
        <div class="detail-header">
            <button class="btn btn-default" onclick="backToList()" style="margin-bottom: 16px;">â† è¿”å›åˆ—è¡¨</button>
            <h1 id="detail-title">Londonä¸­é¤æ¦œ</h1>
            <div class="card-tags">
                <span class="tag tag-blue" id="detail-location">London</span>
            </div>
            <div class="detail-description" id="detail-description">
                å‘ç°Londonåœ°åŒºæœ€å—æ¬¢è¿çš„ä¸­é¤å…ï¼Œç”±ç¤¾åŒºæŠ•ç¥¨å†³å®šæ’åã€‚
            </div>
            <button class="btn btn-primary" onclick="showSubmitItemModal()" style="margin-top: 16px;">
                â• æäº¤ç«å“
            </button>
        </div>
        
        <div class="sort-selector">
            <label>æ’åºæ–¹å¼ï¼š</label>
            <select id="sort-selector" onchange="changeSort()">
                <option value="vote_score">ç»¼åˆå¾—åˆ†</option>
                <option value="net_votes">å‡€èµæ•°</option>
                <option value="upvotes">ç‚¹èµæ•°</option>
                <option value="created_at">æœ€æ–°æäº¤</option>
            </select>
        </div>
        
        <div class="items-list" id="items-list">
            <!-- ç¤ºä¾‹ç«å“å¡ç‰‡ -->
            <div class="item-card">
                <div class="item-header">
                    <div style="display: flex; align-items: start; flex: 1;">
                        <span class="item-rank top3">#1</span>
                        <div class="item-info">
                            <div class="item-name">æµ·åº•æ</div>
                            <div class="item-description">
                                æ­£å®—å››å·ç«é”…ï¼ŒæœåŠ¡è´´å¿ƒï¼Œç¯å¢ƒä¼˜é›…ã€‚æ¨èéº»è¾£é”…åº•å’Œç•ªèŒ„é”…åº•ã€‚
                            </div>
                            <div class="item-address">ğŸ“ 123 Oxford Street, London W1D 2HX</div>
                            <div class="item-images" data-images='["https://via.placeholder.com/100x100?text=å›¾ç‰‡1", "https://via.placeholder.com/100x100?text=å›¾ç‰‡2"]'>
                                <!-- å›¾ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€æ¸²æŸ“ -->
                            </div>
                        </div>
                    </div>
                    <div class="vote-section">
                        <button class="vote-btn active" onclick="handleVote(1, 'upvote')">
                            ğŸ‘ <span class="vote-count">45</span>
                        </button>
                        <button class="vote-btn" onclick="handleVote(1, 'downvote')">
                            ğŸ‘ <span class="vote-count">3</span>
                        </button>
                        <div class="net-votes">å‡€èµ: 42</div>
                    </div>
                </div>
                <div class="user-comment">
                    <div class="user-comment-header">
                        ğŸ‘ ä½ çš„ç•™è¨€ï¼š
                        <span class="anonymous-tag">åŒ¿å</span>
                    </div>
                    <div>å‘³é“å¾ˆæ£’ï¼ŒæœåŠ¡ä¹Ÿå¾ˆå‘¨åˆ°ï¼Œå¼ºçƒˆæ¨èï¼</div>
                </div>
            </div>
            
            <div class="item-card">
                <div class="item-header">
                    <div style="display: flex; align-items: start; flex: 1;">
                        <span class="item-rank top3">#2</span>
                        <div class="item-info">
                            <div class="item-name">æ–‡å…´é…’å®¶</div>
                            <div class="item-description">
                                ä¼ ç»Ÿç²¤èœï¼Œçƒ§è…Šç‰¹åˆ«å¥½åƒï¼Œä»·æ ¼å®æƒ ã€‚
                            </div>
                            <div class="item-address">ğŸ“ 45 Gerrard Street, London W1D 5QJ</div>
                            <div class="item-images" data-images='[]'>
                                <!-- æ²¡æœ‰å›¾ç‰‡ï¼Œæ˜¾ç¤ºå ä½ç¬¦ -->
                            </div>
                        </div>
                    </div>
                    <div class="vote-section">
                        <button class="vote-btn" onclick="handleVote(2, 'upvote')">
                            ğŸ‘ <span class="vote-count">38</span>
                        </button>
                        <button class="vote-btn" onclick="handleVote(2, 'downvote')">
                            ğŸ‘ <span class="vote-count">5</span>
                        </button>
                        <div class="net-votes">å‡€èµ: 33</div>
                    </div>
                </div>
            </div>
            
            <div class="item-card">
                <div class="item-header">
                    <div style="display: flex; align-items: start; flex: 1;">
                        <span class="item-rank top3">#3</span>
                        <div class="item-info">
                            <div class="item-name">èœ€é¦™å›­</div>
                            <div class="item-description">
                                å·èœé¦†ï¼Œéº»å©†è±†è…å’Œå®«ä¿é¸¡ä¸éƒ½å¾ˆæ­£å®—ã€‚
                            </div>
                            <div class="item-address">ğŸ“ 78 Shaftesbury Avenue, London W1D 5EZ</div>
                            <div class="item-images" data-images='["https://via.placeholder.com/100x100?text=èœ€é¦™å›­"]'>
                                <!-- å›¾ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€æ¸²æŸ“ -->
                            </div>
                        </div>
                    </div>
                    <div class="vote-section">
                        <button class="vote-btn" onclick="handleVote(3, 'upvote')">
                            ğŸ‘ <span class="vote-count">32</span>
                        </button>
                        <button class="vote-btn danger active" onclick="handleVote(3, 'downvote')">
                            ğŸ‘ <span class="vote-count">8</span>
                        </button>
                        <div class="net-votes">å‡€èµ: 24</div>
                    </div>
                </div>
                <div class="user-comment">
                    <div class="user-comment-header">
                        ğŸ‘ ä½ çš„ç•™è¨€ï¼š
                    </div>
                    <div>æœåŠ¡æ€åº¦ä¸€èˆ¬ï¼Œä¸Šèœé€Ÿåº¦è¾ƒæ…¢ã€‚</div>
                </div>
            </div>
            
            <div class="item-card">
                <div class="item-header">
                    <div style="display: flex; align-items: start; flex: 1;">
                        <span class="item-rank other">#4</span>
                        <div class="item-info">
                            <div class="item-name">è€åŒ—äº¬</div>
                            <div class="item-description">
                                åŒ—äº¬èœï¼Œçƒ¤é¸­æ˜¯æ‹›ç‰Œï¼Œéœ€è¦æå‰é¢„è®¢ã€‚
                            </div>
                            <div class="item-address">ğŸ“ 12 Wardour Street, London W1D 6PL</div>
                            <div class="item-images" data-images='["https://via.placeholder.com/100x100?text=è€åŒ—äº¬1", "https://via.placeholder.com/100x100?text=è€åŒ—äº¬2"]'>
                                <!-- å›¾ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€æ¸²æŸ“ -->
                            </div>
                        </div>
                    </div>
                    <div class="vote-section">
                        <button class="vote-btn" onclick="handleVote(4, 'upvote')">
                            ğŸ‘ <span class="vote-count">28</span>
                        </button>
                        <button class="vote-btn" onclick="handleVote(4, 'downvote')">
                            ğŸ‘ <span class="vote-count">2</span>
                        </button>
                        <div class="net-votes">å‡€èµ: 26</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ç”³è¯·æ¦œå•æ¨¡æ€æ¡† -->
    <div id="apply-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">ç”³è¯·æ–°æ¦œå•</div>
            <form id="apply-form">
                <div class="form-group">
                    <label>æ¦œå•åç§° *</label>
                    <input type="text" name="name" placeholder="ä¾‹å¦‚ï¼šLondonä¸­é¤æ¦œ" required>
                </div>
                
                <div class="form-group">
                    <label>åŸå¸‚ *</label>
                    <select name="location" required>
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="Online">Online</option>
                        <option value="London">London</option>
                        <option value="Edinburgh">Edinburgh</option>
                        <option value="Manchester">Manchester</option>
                        <option value="Birmingham">Birmingham</option>
                        <option value="Glasgow">Glasgow</option>
                        <option value="Bristol">Bristol</option>
                        <option value="Sheffield">Sheffield</option>
                        <option value="Leeds">Leeds</option>
                        <option value="Nottingham">Nottingham</option>
                        <option value="Newcastle">Newcastle</option>
                        <option value="Southampton">Southampton</option>
                        <option value="Liverpool">Liverpool</option>
                        <option value="Cardiff">Cardiff</option>
                        <option value="Coventry">Coventry</option>
                        <option value="Exeter">Exeter</option>
                        <option value="Leicester">Leicester</option>
                        <option value="York">York</option>
                        <option value="Aberdeen">Aberdeen</option>
                        <option value="Bath">Bath</option>
                        <option value="Dundee">Dundee</option>
                        <option value="Reading">Reading</option>
                        <option value="St Andrews">St Andrews</option>
                        <option value="Belfast">Belfast</option>
                        <option value="Brighton">Brighton</option>
                        <option value="Durham">Durham</option>
                        <option value="Norwich">Norwich</option>
                        <option value="Swansea">Swansea</option>
                        <option value="Loughborough">Loughborough</option>
                        <option value="Lancaster">Lancaster</option>
                        <option value="Warwick">Warwick</option>
                        <option value="Cambridge">Cambridge</option>
                        <option value="Oxford">Oxford</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>æ¦œå•æè¿°</label>
                    <textarea name="description" placeholder="æè¿°è¿™ä¸ªæ¦œå•çš„ç›®çš„å’ŒèŒƒå›´"></textarea>
                </div>
                
                <div class="form-group">
                    <label>ç”³è¯·ç†ç”± *</label>
                    <textarea name="application_reason" placeholder="ä¸ºä»€ä¹ˆéœ€è¦åˆ›å»ºè¿™ä¸ªæ¦œå•ï¼Ÿ" required></textarea>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-default" onclick="closeApplyModal()">å–æ¶ˆ</button>
                    <button type="submit" class="btn btn-primary">æäº¤ç”³è¯·</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- æäº¤ç«å“æ¨¡æ€æ¡† -->
    <div id="submit-item-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">æäº¤ç«å“</div>
            <form id="submit-item-form">
                <div class="form-group">
                    <label>ç«å“åç§° *</label>
                    <input type="text" name="name" placeholder="ä¾‹å¦‚ï¼šæµ·åº•æ" required>
                </div>
                
                <div class="form-group">
                    <label>æè¿°</label>
                    <textarea name="description" placeholder="æè¿°è¿™ä¸ªç«å“çš„ç‰¹ç‚¹"></textarea>
                </div>
                
                <div class="form-group">
                    <label>åœ°å€</label>
                    <input type="text" name="address" placeholder="è¯¦ç»†åœ°å€">
                </div>
                
                <div class="form-group">
                    <label>ç”µè¯</label>
                    <input type="text" name="phone" placeholder="è”ç³»ç”µè¯">
                </div>
                
                <div class="form-group">
                    <label>ç½‘ç«™</label>
                    <input type="url" name="website" placeholder="å®˜æ–¹ç½‘ç«™">
                </div>
                
                <div class="form-group">
                    <label>å›¾ç‰‡ï¼ˆæœ€å¤š5å¼ ï¼‰</label>
                    <input type="file" name="images" multiple accept="image/*" onchange="previewImages(this)">
                    <div id="image-preview" style="display: flex; gap: 8px; margin-top: 8px; flex-wrap: wrap;"></div>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-default" onclick="closeSubmitItemModal()">å–æ¶ˆ</button>
                    <button type="submit" class="btn btn-primary">æäº¤</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- æŠ•ç¥¨ç•™è¨€æ¨¡æ€æ¡† -->
    <div id="vote-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header" id="vote-modal-title">ç‚¹èµå¹¶ç•™è¨€</div>
            <form id="vote-form">
                <div class="form-group">
                    <label>ç•™è¨€ï¼ˆå¯é€‰ï¼Œæœ€å¤š500å­—ï¼‰</label>
                    <textarea name="comment" placeholder="åˆ†äº«ä½ çš„ä½¿ç”¨ä½“éªŒï¼Œä¾‹å¦‚ï¼šç‰©ç¾ä»·å»‰ï¼ŒæœåŠ¡äººå‘˜å¾ˆæš–å¿ƒ" maxlength="500"></textarea>
                    <div style="text-align: right; font-size: 12px; color: #999; margin-top: 4px;">
                        <span id="comment-count">0</span>/500
                    </div>
                </div>
                
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" name="is_anonymous" id="is_anonymous">
                        <label for="is_anonymous">åŒ¿åæŠ•ç¥¨/ç•™è¨€</label>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-default" onclick="closeVoteModal()">å–æ¶ˆ</button>
                    <button type="submit" class="btn btn-primary">æäº¤</button>
                </div>
            </form>
        </div>
    </div>
    
    <script>
        // é¡µé¢çŠ¶æ€
        let currentPage = 'list'; // 'list' æˆ– 'detail'
        let currentLeaderboardId = null;
        let currentVoteItemId = null;
        let currentVoteType = null;
        
        // æ˜¾ç¤ºç”³è¯·æ¦œå•æ¨¡æ€æ¡†
        function showApplyModal() {
            document.getElementById('apply-modal').classList.add('show');
        }
        
        function closeApplyModal() {
            document.getElementById('apply-modal').classList.remove('show');
            document.getElementById('apply-form').reset();
        }
        
        // æ˜¾ç¤ºæäº¤ç«å“æ¨¡æ€æ¡†
        function showSubmitItemModal() {
            document.getElementById('submit-item-modal').classList.add('show');
        }
        
        function closeSubmitItemModal() {
            document.getElementById('submit-item-modal').classList.remove('show');
            document.getElementById('submit-item-form').reset();
            document.getElementById('image-preview').innerHTML = '';
        }
        
        // æ˜¾ç¤ºæŠ•ç¥¨ç•™è¨€æ¨¡æ€æ¡†
        function showVoteModal(itemId, voteType) {
            currentVoteItemId = itemId;
            currentVoteType = voteType;
            const title = voteType === 'upvote' ? 'ç‚¹èµå¹¶ç•™è¨€' : 'ç‚¹è¸©å¹¶ç•™è¨€';
            document.getElementById('vote-modal-title').textContent = title;
            document.getElementById('vote-modal').classList.add('show');
        }
        
        function closeVoteModal() {
            document.getElementById('vote-modal').classList.remove('show');
            document.getElementById('vote-form').reset();
            document.getElementById('comment-count').textContent = '0';
            currentVoteItemId = null;
            currentVoteType = null;
        }
        
        // æ‰“å¼€æ¦œå•è¯¦æƒ…
        function openLeaderboardDetail(id) {
            currentLeaderboardId = id;
            document.getElementById('leaderboard-list-page').style.display = 'none';
            document.getElementById('leaderboard-detail-page').style.display = 'block';
            currentPage = 'detail';
            // è¿™é‡Œåº”è¯¥è°ƒç”¨APIåŠ è½½æ¦œå•è¯¦æƒ…å’Œç«å“åˆ—è¡¨
            loadLeaderboardDetail(id);
        }
        
        // è¿”å›åˆ—è¡¨
        function backToList() {
            document.getElementById('leaderboard-list-page').style.display = 'block';
            document.getElementById('leaderboard-detail-page').style.display = 'none';
            currentPage = 'list';
        }
        
        // åŠ è½½æ¦œå•è¯¦æƒ…
        function loadLeaderboardDetail(id) {
            // æ¨¡æ‹ŸAPIè°ƒç”¨
            console.log('åŠ è½½æ¦œå•è¯¦æƒ…:', id);
            // å®é™…åº”è¯¥è°ƒç”¨: getCustomLeaderboardDetail(id)
            // æ¸²æŸ“ç«å“å›¾ç‰‡
            setTimeout(() => {
                renderItemImages();
            }, 100);
        }
        
        // æ¸²æŸ“ç«å“å›¾ç‰‡
        function renderItemImages() {
            const imageContainers = document.querySelectorAll('.item-images[data-images]');
            imageContainers.forEach(container => {
                try {
                    const imagesJson = container.getAttribute('data-images');
                    const images = JSON.parse(imagesJson);
                    
                    if (images && images.length > 0) {
                        container.innerHTML = '';
                        images.forEach((imageUrl, index) => {
                            const img = document.createElement('img');
                            img.src = imageUrl;
                            img.alt = `å›¾ç‰‡${index + 1}`;
                            img.className = 'item-image';
                            img.onerror = function() {
                                // å›¾ç‰‡åŠ è½½å¤±è´¥æ—¶æ˜¾ç¤ºå ä½ç¬¦
                                this.src = 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100"%3E%3Crect width="100" height="100" fill="%23f5f5f5"/%3E%3Ctext x="50%" y="50%" text-anchor="middle" dy=".3em" fill="%23999" font-size="12"%3Eå›¾ç‰‡åŠ è½½å¤±è´¥%3C/text%3E%3C/svg%3E';
                            };
                            img.onclick = function() {
                                // ç‚¹å‡»å›¾ç‰‡å¯ä»¥æ”¾å¤§æŸ¥çœ‹
                                showImageModal(imageUrl);
                            };
                            container.appendChild(img);
                        });
                    } else {
                        // æ²¡æœ‰å›¾ç‰‡æ—¶æ˜¾ç¤ºå ä½ç¬¦
                        container.innerHTML = '<div class="item-image-placeholder">æš‚æ— å›¾ç‰‡</div>';
                    }
                } catch (e) {
                    console.error('è§£æå›¾ç‰‡æ•°æ®å¤±è´¥:', e);
                    container.innerHTML = '<div class="item-image-placeholder">å›¾ç‰‡æ•°æ®é”™è¯¯</div>';
                }
            });
        }
        
        // æ˜¾ç¤ºå›¾ç‰‡æ”¾å¤§æ¨¡æ€æ¡†
        function showImageModal(imageUrl) {
            const modal = document.createElement('div');
            modal.className = 'modal show';
            modal.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 2000; display: flex; align-items: center; justify-content: center; cursor: pointer;';
            modal.onclick = function() {
                document.body.removeChild(modal);
            };
            
            const img = document.createElement('img');
            img.src = imageUrl;
            img.style.cssText = 'max-width: 90%; max-height: 90%; object-fit: contain; border-radius: 8px;';
            img.onclick = function(e) {
                e.stopPropagation();
            };
            
            modal.appendChild(img);
            document.body.appendChild(modal);
        }
        
        // å¤„ç†æŠ•ç¥¨
        function handleVote(itemId, voteType) {
            // æ£€æŸ¥æ˜¯å¦å·²ç™»å½•
            const isLoggedIn = true; // å®é™…åº”è¯¥æ£€æŸ¥ç™»å½•çŠ¶æ€
            
            if (!isLoggedIn) {
                alert('è¯·å…ˆç™»å½•');
                return;
            }
            
            // æ£€æŸ¥æ˜¯å¦å·²æŠ•ç¥¨ï¼ˆå®é™…åº”è¯¥ä»itemæ•°æ®ä¸­è·å–user_voteï¼‰
            const item = getItemById(itemId);
            if (item && item.user_vote === voteType) {
                // å·²æŠ•ç›¸åŒç±»å‹çš„ç¥¨ï¼Œå–æ¶ˆæŠ•ç¥¨
                if (confirm('ç¡®å®šè¦å–æ¶ˆæŠ•ç¥¨å—ï¼Ÿ')) {
                    // è°ƒç”¨API: voteLeaderboardItem(itemId, 'remove')
                    console.log('å–æ¶ˆæŠ•ç¥¨:', itemId);
                }
            } else {
                // æ–°æŠ•ç¥¨æˆ–ä¿®æ”¹æŠ•ç¥¨ï¼Œæ˜¾ç¤ºç•™è¨€è¾“å…¥æ¡†
                showVoteModal(itemId, voteType);
            }
        }
        
        // è·å–ç«å“æ•°æ®ï¼ˆæ¨¡æ‹Ÿï¼‰
        function getItemById(itemId) {
            // å®é™…åº”è¯¥ä»itemsåˆ—è¡¨ä¸­æŸ¥æ‰¾
            return null;
        }
        
        // æ”¹å˜æ’åº
        function changeSort() {
            const sort = document.getElementById('sort-selector').value;
            console.log('æ”¹å˜æ’åº:', sort);
            // è°ƒç”¨API: getLeaderboardItems(currentLeaderboardId, { sort })
        }
        
        // é¢„è§ˆå›¾ç‰‡
        function previewImages(input) {
            const preview = document.getElementById('image-preview');
            preview.innerHTML = '';
            preview.style.display = 'flex';
            
            if (input.files && input.files.length > 0) {
                const maxImages = Math.min(input.files.length, 5);
                
                for (let i = 0; i < maxImages; i++) {
                    const file = input.files[i];
                    
                    // éªŒè¯æ–‡ä»¶ç±»å‹
                    if (!file.type.startsWith('image/')) {
                        alert(`æ–‡ä»¶ ${file.name} ä¸æ˜¯å›¾ç‰‡æ ¼å¼`);
                        continue;
                    }
                    
                    // éªŒè¯æ–‡ä»¶å¤§å°ï¼ˆ5MBï¼‰
                    if (file.size > 5 * 1024 * 1024) {
                        alert(`æ–‡ä»¶ ${file.name} è¶…è¿‡5MBé™åˆ¶`);
                        continue;
                    }
                    
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        const wrapper = document.createElement('div');
                        wrapper.style.cssText = 'position: relative; display: inline-block;';
                        
                        const img = document.createElement('img');
                        img.src = e.target.result;
                        img.style.cssText = 'width: 100px; height: 100px; object-fit: cover; border-radius: 4px; border: 1px solid #e8e8e8; display: block;';
                        
                        const removeBtn = document.createElement('button');
                        removeBtn.textContent = 'Ã—';
                        removeBtn.style.cssText = 'position: absolute; top: -8px; right: -8px; width: 20px; height: 20px; border-radius: 50%; background: #ff4d4f; color: white; border: none; cursor: pointer; font-size: 14px; line-height: 1; display: flex; align-items: center; justify-content: center;';
                        removeBtn.onclick = function() {
                            wrapper.remove();
                            // ä»inputä¸­ç§»é™¤æ–‡ä»¶
                            const dt = new DataTransfer();
                            const files = Array.from(input.files);
                            files.splice(i, 1);
                            files.forEach(f => dt.items.add(f));
                            input.files = dt.files;
                            if (preview.children.length === 0) {
                                preview.style.display = 'none';
                            }
                        };
                        
                        wrapper.appendChild(img);
                        wrapper.appendChild(removeBtn);
                        preview.appendChild(wrapper);
                    };
                    
                    reader.onerror = function() {
                        alert(`è¯»å–æ–‡ä»¶ ${file.name} å¤±è´¥`);
                    };
                    
                    reader.readAsDataURL(file);
                }
                
                if (input.files.length > 5) {
                    alert(`æœ€å¤šåªèƒ½ä¸Šä¼ 5å¼ å›¾ç‰‡ï¼Œå·²é€‰æ‹©å‰5å¼ `);
                }
            } else {
                preview.style.display = 'none';
            }
        }
        
        // è¡¨å•æäº¤
        document.getElementById('apply-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            console.log('æäº¤ç”³è¯·:', Object.fromEntries(formData));
            // è°ƒç”¨API: applyCustomLeaderboard(Object.fromEntries(formData))
            alert('ç”³è¯·å·²æäº¤ï¼Œç­‰å¾…å®¡æ ¸');
            closeApplyModal();
        });
        
        document.getElementById('submit-item-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            console.log('æäº¤ç«å“:', Object.fromEntries(formData));
            // è°ƒç”¨API: submitLeaderboardItem(formData)
            alert('ç«å“æäº¤æˆåŠŸ');
            closeSubmitItemModal();
        });
        
        document.getElementById('vote-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            const comment = formData.get('comment');
            const isAnonymous = formData.get('is_anonymous') === 'on';
            
            console.log('æäº¤æŠ•ç¥¨:', {
                itemId: currentVoteItemId,
                voteType: currentVoteType,
                comment,
                isAnonymous
            });
            
            // è°ƒç”¨API: voteLeaderboardItem(currentVoteItemId, currentVoteType, comment, isAnonymous)
            alert('æŠ•ç¥¨æˆåŠŸ');
            closeVoteModal();
        });
        
        // ç•™è¨€å­—æ•°ç»Ÿè®¡
        const commentTextarea = document.getElementById('vote-form').querySelector('textarea[name="comment"]');
        if (commentTextarea) {
            commentTextarea.addEventListener('input', function(e) {
                const count = e.target.value.length;
                document.getElementById('comment-count').textContent = count;
                if (count > 500) {
                    e.target.value = e.target.value.substring(0, 500);
                    document.getElementById('comment-count').textContent = '500';
                }
            });
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåæ¸²æŸ“å›¾ç‰‡
        document.addEventListener('DOMContentLoaded', function() {
            renderItemImages();
        });
        
        // ç­›é€‰åŠŸèƒ½
        document.getElementById('location-filter').addEventListener('change', function() {
            console.log('ç­›é€‰åŸå¸‚:', this.value);
            // è°ƒç”¨API: getCustomLeaderboards({ location: this.value })
        });
    </script>
</body>
</html>

